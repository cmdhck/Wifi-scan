# Obfuscated by Comradehacker
import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoiIiIKQ09NUkFERUhBQ0tFUiBURUFNIENNREhBQ0sgLSBBRFZBTkNFRCBXSUZJIEFOQUxZWkVSCkFkdmFuY2VkIFdpRmkgc2Nhbm5lciB3aXRoIGRpc3RhbmNlIGVzdGltYXRpb24sIHNlY3VyaXR5IGFuYWx5c2lzLCBhbmQgdGhyZWF0IGRldGVjdGlvbgoiIiIKCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCBqc29uCmltcG9ydCB0aW1lCmltcG9ydCBvcwppbXBvcnQgc3lzCmltcG9ydCBtYXRoCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lLCB0aW1lZGVsdGEKZnJvbSBjb2xsZWN0aW9ucyBpbXBvcnQgT3JkZXJlZERpY3QKaW1wb3J0IHRocmVhZGluZwppbXBvcnQgc2VsZWN0CmltcG9ydCB0ZXJtaW9zCmltcG9ydCB0dHkKZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzCmZyb20gdHlwaW5nIGltcG9ydCBEaWN0LCBMaXN0LCBUdXBsZSwgT3B0aW9uYWwKaW1wb3J0IGhhc2hsaWIKCkBkYXRhY2xhc3MKY2xhc3MgV2lGaU5ldHdvcms6CiAgICAiIiJBZHZhbmNlZCBXaUZpIE5ldHdvcmsgQW5hbHlzaXMiIiIKICAgIGJzc2lkOiBzdHIKICAgIHNzaWQ6IHN0cgogICAgc2lnbmFsX2RibTogaW50CiAgICBmcmVxdWVuY3k6IGZsb2F0CiAgICBjYXBhYmlsaXRpZXM6IHN0cgogICAgY2hhbm5lbDogaW50ID0gMAogICAgc2VjdXJpdHlfbGV2ZWw6IHN0ciA9ICJVbmtub3duIgogICAgYmFuZDogc3RyID0gIjIuNEdIeiIKICAgIGVzdGltYXRlZF9kaXN0YW5jZTogZmxvYXQgPSAwLjAKICAgIHZ1bG5lcmFiaWxpdHk6IHN0ciA9ICJBbmFseXppbmcuLi4iCiAgICB0aHJlYXRfbGV2ZWw6IHN0ciA9ICJMb3ciCiAgICBpc19zdXNwaWNpb3VzOiBib29sID0gRmFsc2UKICAgIGVuY3J5cHRpb25fdHlwZTogc3RyID0gIlVua25vd24iCiAgICBmaXJzdF9zZWVuOiBkYXRldGltZSA9IE5vbmUKICAgIGxhc3Rfc2VlbjogZGF0ZXRpbWUgPSBOb25lCiAgICBwYWNrZXRzX2NhcHR1cmVkOiBpbnQgPSAwCiAgICBzaWduYWxfcXVhbGl0eTogc3RyID0gIlBvb3IiCiAgICAKICAgIGRlZiBfX3Bvc3RfaW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuZmlyc3Rfc2VlbiA9IGRhdGV0aW1lLm5vdygpCiAgICAgICAgc2VsZi5sYXN0X3NlZW4gPSBkYXRldGltZS5ub3coKQogICAgICAgIHNlbGYuYW5hbHl6ZV9uZXR3b3JrKCkKICAgIAogICAgZGVmIGFuYWx5emVfbmV0d29yayhzZWxmKToKICAgICAgICAiIiJDb21wcmVoZW5zaXZlIG5ldHdvcmsgYW5hbHlzaXMiIiIKICAgICAgICAjIERldGVybWluZSBiYW5kCiAgICAgICAgaWYgMjQwMCA8PSBzZWxmLmZyZXF1ZW5jeSA8PSAyNTAwOgogICAgICAgICAgICBzZWxmLmJhbmQgPSAiMi40R0h6IgogICAgICAgIGVsaWYgNDkwMCA8PSBzZWxmLmZyZXF1ZW5jeSA8PSA1OTAwOgogICAgICAgICAgICBzZWxmLmJhbmQgPSAiNUdIeiIKICAgICAgICBlbGlmIHNlbGYuZnJlcXVlbmN5ID4gNTkwMDoKICAgICAgICAgICAgc2VsZi5iYW5kID0gIjZHSHoiCiAgICAgICAgCiAgICAgICAgIyBDYWxjdWxhdGUgY2hhbm5lbAogICAgICAgIHNlbGYuY2hhbm5lbCA9IHNlbGYuY2FsY3VsYXRlX2NoYW5uZWwoKQogICAgICAgIAogICAgICAgICMgRXN0aW1hdGUgZGlzdGFuY2UKICAgICAgICBzZWxmLmVzdGltYXRlZF9kaXN0YW5jZSA9IHNlbGYuY2FsY3VsYXRlX2Rpc3RhbmNlKCkKICAgICAgICAKICAgICAgICAjIEFuYWx5emUgc2VjdXJpdHkKICAgICAgICBzZWxmLmFuYWx5emVfc2VjdXJpdHkoKQogICAgICAgIAogICAgICAgICMgRGV0ZXJtaW5lIHRocmVhdCBsZXZlbAogICAgICAgIHNlbGYuYXNzZXNzX3RocmVhdCgpCiAgICAgICAgCiAgICAgICAgIyBEZXRlcm1pbmUgc2lnbmFsIHF1YWxpdHkKICAgICAgICBzZWxmLmRldGVybWluZV9zaWduYWxfcXVhbGl0eSgpCiAgICAKICAgIGRlZiBjYWxjdWxhdGVfY2hhbm5lbChzZWxmKSAtPiBpbnQ6CiAgICAgICAgIiIiQ2FsY3VsYXRlIFdpRmkgY2hhbm5lbCBmcm9tIGZyZXF1ZW5jeSIiIgogICAgICAgIGZyZXFfbWh6ID0gaW50KHNlbGYuZnJlcXVlbmN5KQogICAgICAgIAogICAgICAgICMgMi40IEdIeiBiYW5kCiAgICAgICAgaWYgMjQxMiA8PSBmcmVxX21oeiA8PSAyNDg0OgogICAgICAgICAgICByZXR1cm4gKGZyZXFfbWh6IC0gMjQxMikgLy8gNSArIDEKICAgICAgICAjIDUgR0h6IGJhbmQKICAgICAgICBlbGlmIDUxODAgPD0gZnJlcV9taHogPD0gNTgyNToKICAgICAgICAgICAgcmV0dXJuIChmcmVxX21oeiAtIDUxODApIC8vIDUgKyAzNgogICAgICAgICMgNiBHSHogYmFuZAogICAgICAgIGVsaWYgNTk0NSA8PSBmcmVxX21oeiA8PSA3MTI1OgogICAgICAgICAgICByZXR1cm4gKGZyZXFfbWh6IC0gNTk0NSkgLy8gNSArIDEKICAgICAgICByZXR1cm4gMAogICAgCiAgICBkZWYgY2FsY3VsYXRlX2Rpc3RhbmNlKHNlbGYpIC0+IGZsb2F0OgogICAgICAgICIiIkVzdGltYXRlIGRpc3RhbmNlIGZyb20gc2lnbmFsIHN0cmVuZ3RoIHdpdGggaGlnaCBhY2N1cmFjeSIiIgogICAgICAgICMgQWR2YW5jZWQgZGlzdGFuY2UgZXN0aW1hdGlvbiB1c2luZyBtdWx0aXBsZSBmYWN0b3JzCiAgICAgICAgZnJlcV9naHogPSBzZWxmLmZyZXF1ZW5jeSAvIDEwMDAKICAgICAgICAKICAgICAgICAjIFBhdGggbG9zcyBleHBvbmVudCAodmFyaWVzIGJ5IGVudmlyb25tZW50OiAyPWZyZWUgc3BhY2UsIDQ9dXJiYW4pCiAgICAgICAgcGF0aF9sb3NzX2V4cG9uZW50ID0gMy4wCiAgICAgICAgCiAgICAgICAgIyBSZWZlcmVuY2UgZGlzdGFuY2UgKDEgbWV0ZXIpIHNpZ25hbCBzdHJlbmd0aAogICAgICAgICMgVHlwaWNhbCB2YWx1ZXM6IC0zMGRCbSBhdCAxbSBmb3IgMi40R0h6LCAtMzVkQm0gZm9yIDVHSHoKICAgICAgICBpZiBzZWxmLmJhbmQgPT0gIjIuNEdIeiI6CiAgICAgICAgICAgIHJlZmVyZW5jZV9yc3NpID0gLTM1CiAgICAgICAgZWxpZiBzZWxmLmJhbmQgPT0gIjVHSHoiOgogICAgICAgICAgICByZWZlcmVuY2VfcnNzaSA9IC00MAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJlZmVyZW5jZV9yc3NpID0gLTQ1CiAgICAgICAgCiAgICAgICAgIyBDYWxjdWxhdGUgZGlzdGFuY2UgdXNpbmcgbG9nLWRpc3RhbmNlIHBhdGggbG9zcyBtb2RlbAogICAgICAgIHRyeToKICAgICAgICAgICAgIyBQTChkKSA9IFBMKGQwKSArIDEwKm4qbG9nMTAoZC9kMCkgKyBYz4MKICAgICAgICAgICAgIyBXaGVyZSBuIGlzIHBhdGggbG9zcyBleHBvbmVudCwgZDAgaXMgcmVmZXJlbmNlIGRpc3RhbmNlCiAgICAgICAgICAgIAogICAgICAgICAgICAjIFNpbXBsaWZpZWQgY2FsY3VsYXRpb24KICAgICAgICAgICAgcnNzaV9kaWZmID0gcmVmZXJlbmNlX3Jzc2kgLSBzZWxmLnNpZ25hbF9kYm0KICAgICAgICAgICAgZGlzdGFuY2UgPSAxMCAqKiAocnNzaV9kaWZmIC8gKDEwICogcGF0aF9sb3NzX2V4cG9uZW50KSkKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQXBwbHkgZnJlcXVlbmN5IGNvcnJlY3Rpb24KICAgICAgICAgICAgZGlzdGFuY2UgKj0gbWF0aC5zcXJ0KGZyZXFfZ2h6IC8gMi40KQogICAgICAgICAgICAKICAgICAgICAgICAgIyBSb3VuZCB0byByZWFzb25hYmxlIHZhbHVlcwogICAgICAgICAgICBpZiBkaXN0YW5jZSA8IDAuMToKICAgICAgICAgICAgICAgIHJldHVybiAwLjEKICAgICAgICAgICAgZWxpZiBkaXN0YW5jZSA+IDEwMDoKICAgICAgICAgICAgICAgIHJldHVybiAxMDAuMAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmV0dXJuIHJvdW5kKGRpc3RhbmNlLCAxKQogICAgICAgICAgICAgICAgCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAjIEZhbGxiYWNrIHRvIHNpbXBsZSBlc3RpbWF0aW9uCiAgICAgICAgICAgIGlmIHNlbGYuc2lnbmFsX2RibSA+PSAtMzA6CiAgICAgICAgICAgICAgICByZXR1cm4gMC4xCiAgICAgICAgICAgIGVsaWYgc2VsZi5zaWduYWxfZGJtID49IC00MDoKICAgICAgICAgICAgICAgIHJldHVybiAxLjAKICAgICAgICAgICAgZWxpZiBzZWxmLnNpZ25hbF9kYm0gPj0gLTUwOgogICAgICAgICAgICAgICAgcmV0dXJuIDMuMAogICAgICAgICAgICBlbGlmIHNlbGYuc2lnbmFsX2RibSA+PSAtNjA6CiAgICAgICAgICAgICAgICByZXR1cm4gMTAuMAogICAgICAgICAgICBlbGlmIHNlbGYuc2lnbmFsX2RibSA+PSAtNzA6CiAgICAgICAgICAgICAgICByZXR1cm4gMjAuMAogICAgICAgICAgICBlbGlmIHNlbGYuc2lnbmFsX2RibSA+PSAtODA6CiAgICAgICAgICAgICAgICByZXR1cm4gMzUuMAogICAgICAgICAgICBlbGlmIHNlbGYuc2lnbmFsX2RibSA+PSAtOTA6CiAgICAgICAgICAgICAgICByZXR1cm4gNTAuMAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmV0dXJuIDEwMC4wCiAgICAKICAgIGRlZiBhbmFseXplX3NlY3VyaXR5KHNlbGYpOgogICAgICAgICIiIkFkdmFuY2VkIHNlY3VyaXR5IHZ1bG5lcmFiaWxpdHkgYW5hbHlzaXMiIiIKICAgICAgICBjYXBzID0gc2VsZi5jYXBhYmlsaXRpZXMubG93ZXIoKQogICAgICAgIAogICAgICAgICMgRGljdGlvbmFyeSBvZiBzZWN1cml0eSBwYXR0ZXJucyBhbmQgdGhlaXIgdnVsbmVyYWJpbGl0aWVzCiAgICAgICAgc2VjdXJpdHlfcGF0dGVybnMgPSB7CiAgICAgICAgICAgICd3cGEzJzogewogICAgICAgICAgICAgICAgJ2VuY3J5cHRpb24nOiAnV1BBMy1QZXJzb25hbC9FbnRlcnByaXNlJywKICAgICAgICAgICAgICAgICdsZXZlbCc6ICdWZXJ5IFNlY3VyZScsCiAgICAgICAgICAgICAgICAndnVsbmVyYWJpbGl0eSc6ICdOb3QgQ3JhY2thYmxlJywKICAgICAgICAgICAgICAgICdjcmFja2FibGUnOiBGYWxzZQogICAgICAgICAgICB9LAogICAgICAgICAgICAnd3BhMi1lbnRlcnByaXNlJzogewogICAgICAgICAgICAgICAgJ2VuY3J5cHRpb24nOiAnV1BBMi1FbnRlcnByaXNlJywKICAgICAgICAgICAgICAgICdsZXZlbCc6ICdTZWN1cmUnLAogICAgICAgICAgICAgICAgJ3Z1bG5lcmFiaWxpdHknOiAnU2VjdXJlIChSYWRpdXMgU2VydmVyKScsCiAgICAgICAgICAgICAgICAnY3JhY2thYmxlJzogRmFsc2UKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ3dwYTItcHNrJzogewogICAgICAgICAgICAgICAgJ2VuY3J5cHRpb24nOiAnV1BBMi1QU0snLAogICAgICAgICAgICAgICAgJ2xldmVsJzogJ1NlY3VyZScsCiAgICAgICAgICAgICAgICAndnVsbmVyYWJpbGl0eSc6ICdDcmFja2FibGUgKFdlYWsgUGFzc3dvcmRzKScsCiAgICAgICAgICAgICAgICAnY3JhY2thYmxlJzogVHJ1ZQogICAgICAgICAgICB9LAogICAgICAgICAgICAnd3BhLXBzayc6IHsKICAgICAgICAgICAgICAgICdlbmNyeXB0aW9uJzogJ1dQQS1QU0snLAogICAgICAgICAgICAgICAgJ2xldmVsJzogJ01vZGVyYXRlJywKICAgICAgICAgICAgICAgICd2dWxuZXJhYmlsaXR5JzogJ1Z1bG5lcmFibGUgKFRLSVAvV1BBMSknLAogICAgICAgICAgICAgICAgJ2NyYWNrYWJsZSc6IFRydWUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ3dlcCc6IHsKICAgICAgICAgICAgICAgICdlbmNyeXB0aW9uJzogJ1dFUCcsCiAgICAgICAgICAgICAgICAnbGV2ZWwnOiAnVmVyeSBXZWFrJywKICAgICAgICAgICAgICAgICd2dWxuZXJhYmlsaXR5JzogJ0Vhc2lseSBDcmFja2FibGUnLAogICAgICAgICAgICAgICAgJ2NyYWNrYWJsZSc6IFRydWUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ29wZW4nOiB7CiAgICAgICAgICAgICAgICAnZW5jcnlwdGlvbic6ICdPUEVOJywKICAgICAgICAgICAgICAgICdsZXZlbCc6ICdObyBTZWN1cml0eScsCiAgICAgICAgICAgICAgICAndnVsbmVyYWJpbGl0eSc6ICdPcGVuIE5ldHdvcmsnLAogICAgICAgICAgICAgICAgJ2NyYWNrYWJsZSc6IFRydWUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ293ZSc6IHsKICAgICAgICAgICAgICAgICdlbmNyeXB0aW9uJzogJ09XRScsCiAgICAgICAgICAgICAgICAnbGV2ZWwnOiAnU2VjdXJlJywKICAgICAgICAgICAgICAgICd2dWxuZXJhYmlsaXR5JzogJ0VuaGFuY2VkIE9wZW4nLAogICAgICAgICAgICAgICAgJ2NyYWNrYWJsZSc6IEZhbHNlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICdzYWUnOiB7CiAgICAgICAgICAgICAgICAnZW5jcnlwdGlvbic6ICdXUEEzLVNBRScsCiAgICAgICAgICAgICAgICAnbGV2ZWwnOiAnVmVyeSBTZWN1cmUnLAogICAgICAgICAgICAgICAgJ3Z1bG5lcmFiaWxpdHknOiAnRHJhZ29uZmx5IFByb3RvY29sJywKICAgICAgICAgICAgICAgICdjcmFja2FibGUnOiBGYWxzZQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgICMgQ2hlY2sgZm9yIGVudGVycHJpc2Ugc2VjdXJpdHkgZmlyc3QKICAgICAgICBpZiAnODAyLjF4JyBpbiBjYXBzIG9yICdlYXAnIGluIGNhcHM6CiAgICAgICAgICAgIHBhdHRlcm4gPSAnd3BhMi1lbnRlcnByaXNlJwogICAgICAgIGVsaWYgJ3dwYTMnIGluIGNhcHM6CiAgICAgICAgICAgIHBhdHRlcm4gPSAnd3BhMycKICAgICAgICBlbGlmICd3cGEyJyBpbiBjYXBzIGFuZCAncHNrJyBpbiBjYXBzOgogICAgICAgICAgICBwYXR0ZXJuID0gJ3dwYTItcHNrJwogICAgICAgIGVsaWYgJ3dwYScgaW4gY2FwcyBhbmQgJ3BzaycgaW4gY2FwczoKICAgICAgICAgICAgcGF0dGVybiA9ICd3cGEtcHNrJwogICAgICAgIGVsaWYgJ3dlcCcgaW4gY2FwczoKICAgICAgICAgICAgcGF0dGVybiA9ICd3ZXAnCiAgICAgICAgZWxpZiAnb3BlbicgaW4gY2FwcyBvciAnbm9uZScgaW4gY2FwcyBvciAnW2Vzc10nIGluIGNhcHM6CiAgICAgICAgICAgIHBhdHRlcm4gPSAnb3BlbicKICAgICAgICBlbGlmICdvd2UnIGluIGNhcHM6CiAgICAgICAgICAgIHBhdHRlcm4gPSAnb3dlJwogICAgICAgIGVsaWYgJ3NhZScgaW4gY2FwczoKICAgICAgICAgICAgcGF0dGVybiA9ICdzYWUnCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcGF0dGVybiA9IE5vbmUKICAgICAgICAKICAgICAgICBpZiBwYXR0ZXJuIGFuZCBwYXR0ZXJuIGluIHNlY3VyaXR5X3BhdHRlcm5zOgogICAgICAgICAgICBzZWNfaW5mbyA9IHNlY3VyaXR5X3BhdHRlcm5zW3BhdHRlcm5dCiAgICAgICAgICAgIHNlbGYuZW5jcnlwdGlvbl90eXBlID0gc2VjX2luZm9bJ2VuY3J5cHRpb24nXQogICAgICAgICAgICBzZWxmLnNlY3VyaXR5X2xldmVsID0gc2VjX2luZm9bJ2xldmVsJ10KICAgICAgICAgICAgc2VsZi52dWxuZXJhYmlsaXR5ID0gc2VjX2luZm9bJ3Z1bG5lcmFiaWxpdHknXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZW5jcnlwdGlvbl90eXBlID0gIlVua25vd24iCiAgICAgICAgICAgIHNlbGYuc2VjdXJpdHlfbGV2ZWwgPSAiQW5hbHl6aW5nIgogICAgICAgICAgICBzZWxmLnZ1bG5lcmFiaWxpdHkgPSAiVW5rbm93biBQcm90b2NvbCIKICAgICAgICAKICAgICAgICAjIENoZWNrIGZvciBzcGVjaWZpYyB2dWxuZXJhYmlsaXRpZXMKICAgICAgICB2dWxuX2ZsYWdzID0gW10KICAgICAgICAKICAgICAgICBpZiAnd3BzJyBpbiBjYXBzOgogICAgICAgICAgICB2dWxuX2ZsYWdzLmFwcGVuZCgiV1BTIFBJTiBWdWxuZXJhYmxlIikKICAgICAgICAKICAgICAgICBpZiAndGtpcCcgaW4gY2FwczoKICAgICAgICAgICAgdnVsbl9mbGFncy5hcHBlbmQoIlRLSVAgVnVsbmVyYWJsZSIpCiAgICAgICAgCiAgICAgICAgaWYgJ2NjbXAnIG5vdCBpbiBjYXBzIGFuZCAnd3BhJyBpbiBjYXBzOgogICAgICAgICAgICB2dWxuX2ZsYWdzLmFwcGVuZCgiTm8gQUVTIEVuY3J5cHRpb24iKQogICAgICAgIAogICAgICAgIGlmICdwc2snIGluIGNhcHMgYW5kIGxlbihjYXBzLnNwbGl0KCdwc2snKVswXSkgPCAzOgogICAgICAgICAgICB2dWxuX2ZsYWdzLmFwcGVuZCgiV2VhayBQU0sgQ29uZmlnIikKICAgICAgICAKICAgICAgICBpZiB2dWxuX2ZsYWdzOgogICAgICAgICAgICBzZWxmLnZ1bG5lcmFiaWxpdHkgKz0gIiB8ICIgKyAiIHwgIi5qb2luKHZ1bG5fZmxhZ3MpCiAgICAKICAgIGRlZiBhc3Nlc3NfdGhyZWF0KHNlbGYpOgogICAgICAgICIiIkFzc2VzcyBuZXR3b3JrIHRocmVhdCBsZXZlbCB3aXRoIGFkdmFuY2VkIGhldXJpc3RpY3MiIiIKICAgICAgICBzc2lkX2xvd2VyID0gc2VsZi5zc2lkLmxvd2VyKCkKICAgICAgICAKICAgICAgICAjIFN1c3BpY2lvdXMgU1NJRCBwYXR0ZXJucyAocm9ndWUgQVAgaW5kaWNhdG9ycykKICAgICAgICBzdXNwaWNpb3VzX3BhdHRlcm5zID0gewogICAgICAgICAgICAnY3JpdGljYWwnOiBbCiAgICAgICAgICAgICAgICAnZnJlZXdpZmknLCAncHVibGljd2lmaScsICdndWVzdHdpZmknLCAnaG90c3BvdCcsCiAgICAgICAgICAgICAgICAnYXR0d2lmaScsICd4ZmluaXR5d2lmaScsICdjYWJsZXdpZmknLAogICAgICAgICAgICAgICAgJ2FpcnBvcnQnLCAnc3RhcmJ1Y2tzJywgJ21jZG9uYWxkcycsICdkZWZhdWx0JwogICAgICAgICAgICBdLAogICAgICAgICAgICAnaGlnaCc6IFsKICAgICAgICAgICAgICAgICdhZG1pbicsICdyb3V0ZXInLCAnbW9kZW0nLCAnc2V0dXAnLCAnY29uZmlnJywKICAgICAgICAgICAgICAgICdsaW5rc3lzJywgJ25ldGdlYXInLCAnZGxpbmsnLCAndHBsaW5rJywKICAgICAgICAgICAgICAgICdhbmRyb2lkYXAnLCAnaXBob25lJywgJ21vYmlsZWhvdHNwb3QnCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgICdtZWRpdW0nOiBbCiAgICAgICAgICAgICAgICAnaG9tZScsICdmYW1pbHknLCAnaG91c2UnLCAnbXl3aWZpJywgJ3dpcmVsZXNzJywKICAgICAgICAgICAgICAgICd0ZXN0JywgJ3RlbXAnLCAnZGVtbycsICdiYWNrdXAnCiAgICAgICAgICAgIF0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgIyBDaGVjayBTU0lEIHBhdHRlcm5zCiAgICAgICAgdGhyZWF0X3Njb3JlID0gMAogICAgICAgIAogICAgICAgIGZvciBsZXZlbCwgcGF0dGVybnMgaW4gc3VzcGljaW91c19wYXR0ZXJucy5pdGVtcygpOgogICAgICAgICAgICBmb3IgcGF0dGVybiBpbiBwYXR0ZXJuczoKICAgICAgICAgICAgICAgIGlmIHBhdHRlcm4gaW4gc3NpZF9sb3dlcjoKICAgICAgICAgICAgICAgICAgICBpZiBsZXZlbCA9PSAnY3JpdGljYWwnOgogICAgICAgICAgICAgICAgICAgICAgICB0aHJlYXRfc2NvcmUgKz0gMwogICAgICAgICAgICAgICAgICAgIGVsaWYgbGV2ZWwgPT0gJ2hpZ2gnOgogICAgICAgICAgICAgICAgICAgICAgICB0aHJlYXRfc2NvcmUgKz0gMgogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHRocmVhdF9zY29yZSArPSAxCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAKICAgICAgICAjIENoZWNrIGZvciBoaWRkZW4vbWFsZm9ybWVkIFNTSURzCiAgICAgICAgaWYgbm90IHNlbGYuc3NpZCBvciBzZWxmLnNzaWQgPT0gIjAiIG9yIGxlbihzZWxmLnNzaWQpIDwgMjoKICAgICAgICAgICAgdGhyZWF0X3Njb3JlICs9IDMKICAgICAgICAgICAgc2VsZi5pc19zdXNwaWNpb3VzID0gVHJ1ZQogICAgICAgIAogICAgICAgICMgQ2hlY2sgZm9yIGRlZmF1bHQgbmFtaW5nIHBhdHRlcm5zCiAgICAgICAgZGVmYXVsdF9wYXR0ZXJucyA9IFsnYWRtaW4nLCAncGFzc3dvcmQnLCAnMTIzNDU2NzgnLCAnZGVmYXVsdCddCiAgICAgICAgaWYgYW55KHBhdHRlcm4gaW4gc3NpZF9sb3dlciBmb3IgcGF0dGVybiBpbiBkZWZhdWx0X3BhdHRlcm5zKToKICAgICAgICAgICAgdGhyZWF0X3Njb3JlICs9IDIKICAgICAgICAKICAgICAgICAjIENoZWNrIHNlY3VyaXR5IHZ1bG5lcmFiaWxpdGllcwogICAgICAgIGlmIHNlbGYuc2VjdXJpdHlfbGV2ZWwgaW4gWyJObyBTZWN1cml0eSIsICJWZXJ5IFdlYWsiXToKICAgICAgICAgICAgdGhyZWF0X3Njb3JlICs9IDMKICAgICAgICAgICAgc2VsZi5pc19zdXNwaWNpb3VzID0gVHJ1ZQogICAgICAgIAogICAgICAgIGlmICJDcmFja2FibGUiIGluIHNlbGYudnVsbmVyYWJpbGl0eToKICAgICAgICAgICAgdGhyZWF0X3Njb3JlICs9IDIKICAgICAgICAKICAgICAgICBpZiAiRWFzaWx5IENyYWNrYWJsZSIgaW4gc2VsZi52dWxuZXJhYmlsaXR5OgogICAgICAgICAgICB0aHJlYXRfc2NvcmUgKz0gMwogICAgICAgIAogICAgICAgICMgQ2hlY2sgc2lnbmFsIHN0cmVuZ3RoIGFub21hbGllcwogICAgICAgIGlmIHNlbGYuc2lnbmFsX2RibSA+IC0zMCBhbmQgIkhpZGRlbiIgbm90IGluIHNlbGYuc3NpZDoKICAgICAgICAgICAgIyBFeHRyZW1lbHkgc3Ryb25nIHNpZ25hbCBjb3VsZCBiZSBuZWFyYnkgcm9ndWUgQVAKICAgICAgICAgICAgdGhyZWF0X3Njb3JlICs9IDEKICAgICAgICAKICAgICAgICAjIERldGVybWluZSB0aHJlYXQgbGV2ZWwgYmFzZWQgb24gc2NvcmUKICAgICAgICBpZiB0aHJlYXRfc2NvcmUgPj0gNToKICAgICAgICAgICAgc2VsZi50aHJlYXRfbGV2ZWwgPSAiQ1JJVElDQUwiCiAgICAgICAgICAgIHNlbGYuaXNfc3VzcGljaW91cyA9IFRydWUKICAgICAgICBlbGlmIHRocmVhdF9zY29yZSA+PSAzOgogICAgICAgICAgICBzZWxmLnRocmVhdF9sZXZlbCA9ICJISUdIIgogICAgICAgICAgICBzZWxmLmlzX3N1c3BpY2lvdXMgPSBUcnVlCiAgICAgICAgZWxpZiB0aHJlYXRfc2NvcmUgPj0gMjoKICAgICAgICAgICAgc2VsZi50aHJlYXRfbGV2ZWwgPSAiTUVESVVNIgogICAgICAgIGVsaWYgdGhyZWF0X3Njb3JlID49IDE6CiAgICAgICAgICAgIHNlbGYudGhyZWF0X2xldmVsID0gIkxPVyIKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnRocmVhdF9sZXZlbCA9ICJTQUZFIgogICAgCiAgICBkZWYgZGV0ZXJtaW5lX3NpZ25hbF9xdWFsaXR5KHNlbGYpOgogICAgICAgICIiIkRldGVybWluZSBzaWduYWwgcXVhbGl0eSBiYXNlZCBvbiBtdWx0aXBsZSBmYWN0b3JzIiIiCiAgICAgICAgIyBDYWxjdWxhdGUgc2lnbmFsIHF1YWxpdHkgcGVyY2VudGFnZQogICAgICAgIGlmIHNlbGYuc2lnbmFsX2RibSA+PSAtMzA6CiAgICAgICAgICAgIHF1YWxpdHkgPSAxMDAKICAgICAgICBlbGlmIHNlbGYuc2lnbmFsX2RibSA+PSAtNTA6CiAgICAgICAgICAgIHF1YWxpdHkgPSA4MCArICgoc2VsZi5zaWduYWxfZGJtICsgNTApICogMSkKICAgICAgICBlbGlmIHNlbGYuc2lnbmFsX2RibSA+PSAtNjA6CiAgICAgICAgICAgIHF1YWxpdHkgPSA2MCArICgoc2VsZi5zaWduYWxfZGJtICsgNjApICogMikKICAgICAgICBlbGlmIHNlbGYuc2lnbmFsX2RibSA+PSAtNzA6CiAgICAgICAgICAgIHF1YWxpdHkgPSA0MCArICgoc2VsZi5zaWduYWxfZGJtICsgNzApICogMikKICAgICAgICBlbGlmIHNlbGYuc2lnbmFsX2RibSA+PSAtODA6CiAgICAgICAgICAgIHF1YWxpdHkgPSAyMCArICgoc2VsZi5zaWduYWxfZGJtICsgODApICogMikKICAgICAgICBlbHNlOgogICAgICAgICAgICBxdWFsaXR5ID0gbWF4KDUsIDEwICsgKChzZWxmLnNpZ25hbF9kYm0gKyA5MCkgKiAxKSkKICAgICAgICAKICAgICAgICAjIEFzc2lnbiBxdWFsaXR5IGxldmVsCiAgICAgICAgaWYgcXVhbGl0eSA+PSA4MDoKICAgICAgICAgICAgc2VsZi5zaWduYWxfcXVhbGl0eSA9ICJFeGNlbGxlbnQiCiAgICAgICAgZWxpZiBxdWFsaXR5ID49IDYwOgogICAgICAgICAgICBzZWxmLnNpZ25hbF9xdWFsaXR5ID0gIkdvb2QiCiAgICAgICAgZWxpZiBxdWFsaXR5ID49IDQwOgogICAgICAgICAgICBzZWxmLnNpZ25hbF9xdWFsaXR5ID0gIkZhaXIiCiAgICAgICAgZWxpZiBxdWFsaXR5ID49IDIwOgogICAgICAgICAgICBzZWxmLnNpZ25hbF9xdWFsaXR5ID0gIlBvb3IiCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5zaWduYWxfcXVhbGl0eSA9ICJWZXJ5IFBvb3IiCiAgICAKICAgIGRlZiBnZXRfdGhyZWF0X2NvbG9yKHNlbGYpOgogICAgICAgICIiIkdldCBjb2xvciBjb2RlIGZvciB0aHJlYXQgbGV2ZWwiIiIKICAgICAgICBjb2xvcnMgPSB7CiAgICAgICAgICAgICdDUklUSUNBTCc6ICdcMDMzWzkxbScsICAjIEJyaWdodCBSZWQKICAgICAgICAgICAgJ0hJR0gnOiAnXDAzM1szMW0nLCAgICAgICMgUmVkCiAgICAgICAgICAgICdNRURJVU0nOiAnXDAzM1s5M20nLCAgICAjIFllbGxvdwogICAgICAgICAgICAnTE9XJzogJ1wwMzNbOTJtJywgICAgICAgIyBHcmVlbgogICAgICAgICAgICAnU0FGRSc6ICdcMDMzWzk2bScgICAgICAgIyBDeWFuCiAgICAgICAgfQogICAgICAgIHJldHVybiBjb2xvcnMuZ2V0KHNlbGYudGhyZWF0X2xldmVsLCAnXDAzM1s5N20nKQogICAgCiAgICBkZWYgZ2V0X3NlY3VyaXR5X2NvbG9yKHNlbGYpOgogICAgICAgICIiIkdldCBjb2xvciBjb2RlIGZvciBzZWN1cml0eSBsZXZlbCIiIgogICAgICAgIGNvbG9ycyA9IHsKICAgICAgICAgICAgJ1ZlcnkgU2VjdXJlJzogJ1wwMzNbOTJtJywgICAgIyBHcmVlbgogICAgICAgICAgICAnU2VjdXJlJzogJ1wwMzNbOTZtJywgICAgICAgICAjIEN5YW4KICAgICAgICAgICAgJ01vZGVyYXRlJzogJ1wwMzNbOTNtJywgICAgICAgIyBZZWxsb3cKICAgICAgICAgICAgJ1dlYWsnOiAnXDAzM1s5MW0nLCAgICAgICAgICAgIyBSZWQKICAgICAgICAgICAgJ1ZlcnkgV2Vhayc6ICdcMDMzWzMxbScsICAgICAgIyBCcmlnaHQgUmVkCiAgICAgICAgICAgICdObyBTZWN1cml0eSc6ICdcMDMzWzk1bScgICAgICMgTWFnZW50YQogICAgICAgIH0KICAgICAgICByZXR1cm4gY29sb3JzLmdldChzZWxmLnNlY3VyaXR5X2xldmVsLCAnXDAzM1s5N20nKQoKY2xhc3MgQ29tcmFkZUhhY2tlcldpRmlTY2FubmVyOgogICAgIiIiTWFpbiBzY2FubmVyIGNsYXNzIGZvciBDb21yYWRlSGFja2VyIFRlYW0gQ01ESEFDSyIiIgogICAgCiAgICBkZWYgX19pbml0X18oc2VsZiwgcmVmcmVzaF9pbnRlcnZhbD01KToKICAgICAgICBzZWxmLnJlZnJlc2hfaW50ZXJ2YWwgPSByZWZyZXNoX2ludGVydmFsCiAgICAgICAgc2VsZi5uZXR3b3JrcyA9IE9yZGVyZWREaWN0KCkKICAgICAgICBzZWxmLnNjYW5fY291bnQgPSAwCiAgICAgICAgc2VsZi5ydW5uaW5nID0gRmFsc2UKICAgICAgICBzZWxmLnNjYW5fdGhyZWFkID0gTm9uZQogICAgICAgIHNlbGYudG90YWxfcGFja2V0cyA9IDAKICAgICAgICBzZWxmLnN0YXJ0X3RpbWUgPSBkYXRldGltZS5ub3coKQogICAgICAgIAogICAgICAgICMgQ29sb3JzIGZvciB0ZXJtaW5hbAogICAgICAgIHNlbGYuY29sb3JzID0gewogICAgICAgICAgICAncmVkJzogJ1wwMzNbOTFtJywKICAgICAgICAgICAgJ2dyZWVuJzogJ1wwMzNbOTJtJywKICAgICAgICAgICAgJ3llbGxvdyc6ICdcMDMzWzkzbScsCiAgICAgICAgICAgICdibHVlJzogJ1wwMzNbOTRtJywKICAgICAgICAgICAgJ21hZ2VudGEnOiAnXDAzM1s5NW0nLAogICAgICAgICAgICAnY3lhbic6ICdcMDMzWzk2bScsCiAgICAgICAgICAgICd3aGl0ZSc6ICdcMDMzWzk3bScsCiAgICAgICAgICAgICdib2xkJzogJ1wwMzNbMW0nLAogICAgICAgICAgICAndW5kZXJsaW5lJzogJ1wwMzNbNG0nLAogICAgICAgICAgICAncmVzZXQnOiAnXDAzM1swbScsCiAgICAgICAgICAgICdkYXJrX3JlZCc6ICdcMDMzWzMxbScsCiAgICAgICAgICAgICdkYXJrX2dyZWVuJzogJ1wwMzNbMzJtJywKICAgICAgICAgICAgJ29yYW5nZSc6ICdcMDMzWzMzbScsCiAgICAgICAgICAgICdkYXJrX2JsdWUnOiAnXDAzM1szNG0nLAogICAgICAgICAgICAncHVycGxlJzogJ1wwMzNbMzVtJywKICAgICAgICAgICAgJ2RhcmtfY3lhbic6ICdcMDMzWzM2bScKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgIyBTdGF0aXN0aWNzCiAgICAgICAgc2VsZi5zdGF0cyA9IHsKICAgICAgICAgICAgJ3RvdGFsX25ldHdvcmtzJzogMCwKICAgICAgICAgICAgJ3N1c3BpY2lvdXNfbmV0d29ya3MnOiAwLAogICAgICAgICAgICAnb3Blbl9uZXR3b3Jrcyc6IDAsCiAgICAgICAgICAgICdjcmFja2FibGVfbmV0d29ya3MnOiAwLAogICAgICAgICAgICAnc2VjdXJlX25ldHdvcmtzJzogMCwKICAgICAgICAgICAgJ2J5X2JhbmQnOiB7JzIuNEdIeic6IDAsICc1R0h6JzogMCwgJzZHSHonOiAwfSwKICAgICAgICAgICAgJ2J5X3NlY3VyaXR5Jzoge30sCiAgICAgICAgICAgICdieV90aHJlYXQnOiB7fQogICAgICAgIH0KICAgICAgICAKICAgICAgICBzZWxmLmNoZWNrX3NldHVwKCkKICAgIAogICAgZGVmIGRpc3BsYXlfYmFubmVyKHNlbGYpOgogICAgICAgICIiIkRpc3BsYXkgQ29tcmFkZUhhY2tlciBUZWFtIGJhbm5lciIiIgogICAgICAgIG9zLnN5c3RlbSgnY2xlYXInKQogICAgICAgIHByaW50KGYie3NlbGYuY29sb3JzWydyZWQnXX17c2VsZi5jb2xvcnNbJ2JvbGQnXX0iKQogICAgICAgIHByaW50KCLilZTilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZciKQogICAgICAgIHByaW50KCLilZEgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDilZEiKQogICAgICAgIHByaW50KCLilZEgIOKWkeKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWkeKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWiOKWiOKWiOKVl+KWkeKWkeKWkeKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWkeKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWkeKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KVkSIpCiAgICAgICAgcHJpbnQoIuKVkSAg4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4paI4paI4pWX4paR4paI4paI4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paR4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4pWRIikKICAgICAgICBwcmludCgi4pWRICDilojilojilZHilpHilpHilZrilZDilZ3ilojilojilZHilpHilpHilojilojilZHilojilojilZTilojilojilojilojilZTilojilojilZHilojilojilojilojilojilojilZTilZ3ilojilojilojilojilojilojilojilZHilojilojilZHilpHilpHilojilojilZHilojilojilojilojilojilojilZTilZ3ilojilojilZHilpHilpHilojilojilZfilpHilojilojilojilojilojilZfilpHilpHilZEiKQogICAgICAgIHByaW50KCLilZEgIOKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVl+KWiOKWiOKVkeKWkeKWkeKWiOKWiOKVkeKWiOKWiOKVkeKVmuKWiOKWiOKVlOKVneKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKWiOKWiOKVkeKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVkeKWkeKWkeKVmuKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKVneKWkeKWkeKVkSIpCiAgICAgICAgcHJpbnQoIuKVkSAg4pWa4paI4paI4paI4paI4paI4pWU4pWd4pWa4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4pWR4paR4pWa4pWQ4pWd4paR4paI4paI4pWR4paI4paI4pWR4paR4paR4paI4paI4pWR4paI4paI4pWR4paR4paR4paI4paI4pWR4pWa4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4pWR4paR4paR4paI4paI4pWR4pWa4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4paI4paI4pWX4pWRIikKICAgICAgICBwcmludCgi4pWRICDilpHilZrilZDilZDilZDilZDilZ3ilpHilpHilZrilZDilZDilZDilZDilZ3ilpHilZrilZDilZ3ilpHilpHilpHilpHilpHilZrilZDilZ3ilZrilZDilZ3ilpHilpHilZrilZDilZ3ilZrilZDilZ3ilpHilpHilZrilZDilZ3ilpHilZrilZDilZDilZDilZDilZ3ilpHilZrilZDilZ3ilpHilpHilZrilZDilZ3ilpHilZrilZDilZDilZDilZDilZDilZ3ilpHilZrilZDilZDilZDilZDilZDilZDilZ3ilZEiKQogICAgICAgIHByaW50KCLilZEgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDilZEiKQogICAgICAgIHByaW50KGYi4pWRICB7c2VsZi5jb2xvcnNbJ2N5YW4nXX1DIE8gTSBSIEEgRCBFIEggQSBDIEsgRSBSICAgVCBFIEEgTSAgIC0gICBDIE0gRCBIIEEgQyBLe3NlbGYuY29sb3JzWydyZWQnXX0gICAgICAgICAgICAgICAgICAgIOKVkSIpCiAgICAgICAgcHJpbnQoIuKVkSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKVkSIpCiAgICAgICAgcHJpbnQoIuKVkSAgICAgICAgICAgICAgICAgICAgQURWQU5DRUQgV0lGSSBTRUNVUklUWSBBTkFMWVpFUiAgICAgICAgICAgICAgICAgICAgICAgICAgIOKVkSIpCiAgICAgICAgcHJpbnQoIuKVkSAgICAgICAgICAgICAgICAgICAgVmVyc2lvbiAyLjAgfCBEaXN0YW5jZSArIFNlY3VyaXR5IFNjYW5uZXIgICAgICAgICAgICAgICAgIOKVkSIpCiAgICAgICAgcHJpbnQoIuKVkSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKVkSIpCiAgICAgICAgcHJpbnQoIuKVkSAgICAgICAgICAgICAgICAgICAgICBmb3IgdGVybXV4IHVzZXJzIG9ubHkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDilZEiKQogICAgICAgIHByaW50KGYie3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAKICAgIGRlZiBjaGVja19zZXR1cChzZWxmKToKICAgICAgICAiIiJDaGVjayBpZiBUZXJtdXggaXMgcHJvcGVybHkgc2V0dXAiIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgVHJ5IHRvIHJ1biB0ZXJtdXgtd2lmaS1zY2FuaW5mbwogICAgICAgICAgICByZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bigKICAgICAgICAgICAgICAgIFsnd2hpY2gnLCAndGVybXV4LXdpZmktc2NhbmluZm8nXSwKICAgICAgICAgICAgICAgIGNhcHR1cmVfb3V0cHV0PVRydWUsCiAgICAgICAgICAgICAgICB0ZXh0PVRydWUKICAgICAgICAgICAgKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgcmVzdWx0LnJldHVybmNvZGUgIT0gMDoKICAgICAgICAgICAgICAgIHByaW50KGYie3NlbGYuY29sb3JzWyd5ZWxsb3cnXX3imqAgVGVybXV4IEFQSSBub3QgZm91bmQhe3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgICAgICAgICBwcmludChmIntzZWxmLmNvbG9yc1snd2hpdGUnXX1SdW46e3NlbGYuY29sb3JzWydjeWFuJ119IHBrZyBpbnN0YWxsIHRlcm11eC1hcGkgLXl7c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICAgICAKICAgICAgICAgICAgcHJpbnQoZiJ7c2VsZi5jb2xvcnNbJ2dyZWVuJ1194pyTIFRlcm11eCBBUEkgZGV0ZWN0ZWR7c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAgICAgCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBwcmludChmIntzZWxmLmNvbG9yc1sncmVkJ1194pyXIFNldHVwIGVycm9yOiB7ZX17c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAKICAgIGRlZiBnZXRfc2Nhbl9yZXN1bHRzKHNlbGYpOgogICAgICAgICIiIkdldCBXaUZpIHNjYW4gcmVzdWx0cyBmcm9tIFRlcm11eCBBUEkiIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlc3VsdCA9IHN1YnByb2Nlc3MucnVuKAogICAgICAgICAgICAgICAgWyd0ZXJtdXgtd2lmaS1zY2FuaW5mbyddLAogICAgICAgICAgICAgICAgY2FwdHVyZV9vdXRwdXQ9VHJ1ZSwKICAgICAgICAgICAgICAgIHRleHQ9VHJ1ZSwKICAgICAgICAgICAgICAgIHRpbWVvdXQ9MTAKICAgICAgICAgICAgKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgcmVzdWx0LnJldHVybmNvZGUgPT0gMCBhbmQgcmVzdWx0LnN0ZG91dC5zdHJpcCgpOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIG5ldHdvcmtzID0ganNvbi5sb2FkcyhyZXN1bHQuc3Rkb3V0KQogICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXR3b3JrcyBpZiBpc2luc3RhbmNlKG5ldHdvcmtzLCBsaXN0KSBlbHNlIFtdCiAgICAgICAgICAgICAgICBleGNlcHQganNvbi5KU09ORGVjb2RlRXJyb3I6CiAgICAgICAgICAgICAgICAgICAgIyBUcnkgdG8gY2xlYW4gYW5kIHBhcnNlCiAgICAgICAgICAgICAgICAgICAgY2xlYW5lZCA9IHJlc3VsdC5zdGRvdXQucmVwbGFjZSgiJyIsICciJykucmVwbGFjZSgnTm9uZScsICdudWxsJykKICAgICAgICAgICAgICAgICAgICBuZXR3b3JrcyA9IGpzb24ubG9hZHMoY2xlYW5lZCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV0d29ya3MgaWYgaXNpbnN0YW5jZShuZXR3b3JrcywgbGlzdCkgZWxzZSBbXQogICAgICAgICAgICByZXR1cm4gW10KICAgICAgICAgICAgCiAgICAgICAgZXhjZXB0IHN1YnByb2Nlc3MuVGltZW91dEV4cGlyZWQ6CiAgICAgICAgICAgIHByaW50KGYie3NlbGYuY29sb3JzWyd5ZWxsb3cnXX3imqAgU2NhbiB0aW1lb3V0e3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgICAgIHJldHVybiBbXQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZiJ7c2VsZi5jb2xvcnNbJ3JlZCddfeKclyBTY2FuIGVycm9yOiB7ZX17c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICAgICAgcmV0dXJuIFtdCiAgICAKICAgIGRlZiBwYXJzZV9uZXR3b3JrKHNlbGYsIHJhd19kYXRhKToKICAgICAgICAiIiJQYXJzZSByYXcgbmV0d29yayBkYXRhIGludG8gV2lGaU5ldHdvcmsgb2JqZWN0IiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBic3NpZCA9IHJhd19kYXRhLmdldCgnYnNzaWQnLCAnVW5rbm93bicpLnVwcGVyKCkKICAgICAgICAgICAgc3NpZCA9IHJhd19kYXRhLmdldCgnc3NpZCcsICdIaWRkZW4gTmV0d29yaycpCiAgICAgICAgICAgIAogICAgICAgICAgICAjIEhhbmRsZSBlbXB0eS93ZWlyZCBTU0lEcwogICAgICAgICAgICBpZiBub3Qgc3NpZCBvciBzc2lkIGluIFsnJywgJ251bGwnLCAnTm9uZScsICcwJ106CiAgICAgICAgICAgICAgICBzc2lkID0gZiJIaWRkZW5fe2Jzc2lkWy02Ol19IgogICAgICAgICAgICAKICAgICAgICAgICAgc2lnbmFsID0gcmF3X2RhdGEuZ2V0KCdyc3NpJywgLTEwMCkKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShzaWduYWwsIHN0cik6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgc2lnbmFsID0gaW50KHNpZ25hbCkKICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICBzaWduYWwgPSAtMTAwCiAgICAgICAgICAgIAogICAgICAgICAgICBmcmVxID0gcmF3X2RhdGEuZ2V0KCdmcmVxdWVuY3knLCAyNDEyKQogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGZyZXEsIHN0cik6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgZnJlcSA9IGZsb2F0KGZyZXEpCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgZnJlcSA9IDI0MTIKICAgICAgICAgICAgCiAgICAgICAgICAgIGNhcHMgPSByYXdfZGF0YS5nZXQoJ2NhcGFiaWxpdGllcycsICcnKQogICAgICAgICAgICAKICAgICAgICAgICAgIyBDcmVhdGUgbmV0d29yayBvYmplY3QKICAgICAgICAgICAgbmV0d29yayA9IFdpRmlOZXR3b3JrKAogICAgICAgICAgICAgICAgYnNzaWQ9YnNzaWQsCiAgICAgICAgICAgICAgICBzc2lkPXNzaWQsCiAgICAgICAgICAgICAgICBzaWduYWxfZGJtPWludChzaWduYWwpLAogICAgICAgICAgICAgICAgZnJlcXVlbmN5PWZsb2F0KGZyZXEpLAogICAgICAgICAgICAgICAgY2FwYWJpbGl0aWVzPXN0cihjYXBzKQogICAgICAgICAgICApCiAgICAgICAgICAgIAogICAgICAgICAgICByZXR1cm4gbmV0d29yawogICAgICAgICAgICAKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHByaW50KGYie3NlbGYuY29sb3JzWydyZWQnXX1QYXJzZSBlcnJvcjoge2V9e3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAKICAgIGRlZiB1cGRhdGVfc3RhdGlzdGljcyhzZWxmKToKICAgICAgICAiIiJVcGRhdGUgc2NhbiBzdGF0aXN0aWNzIiIiCiAgICAgICAgc2VsZi5zdGF0cyA9IHsKICAgICAgICAgICAgJ3RvdGFsX25ldHdvcmtzJzogbGVuKHNlbGYubmV0d29ya3MpLAogICAgICAgICAgICAnc3VzcGljaW91c19uZXR3b3Jrcyc6IHN1bSgxIGZvciBuIGluIHNlbGYubmV0d29ya3MudmFsdWVzKCkgaWYgbi5pc19zdXNwaWNpb3VzKSwKICAgICAgICAgICAgJ29wZW5fbmV0d29ya3MnOiBzdW0oMSBmb3IgbiBpbiBzZWxmLm5ldHdvcmtzLnZhbHVlcygpIGlmIG4uc2VjdXJpdHlfbGV2ZWwgPT0gJ05vIFNlY3VyaXR5JyksCiAgICAgICAgICAgICdjcmFja2FibGVfbmV0d29ya3MnOiBzdW0oMSBmb3IgbiBpbiBzZWxmLm5ldHdvcmtzLnZhbHVlcygpIGlmICdDcmFja2FibGUnIGluIG4udnVsbmVyYWJpbGl0eSksCiAgICAgICAgICAgICdzZWN1cmVfbmV0d29ya3MnOiBzdW0oMSBmb3IgbiBpbiBzZWxmLm5ldHdvcmtzLnZhbHVlcygpIGlmIG4uc2VjdXJpdHlfbGV2ZWwgaW4gWydTZWN1cmUnLCAnVmVyeSBTZWN1cmUnXSksCiAgICAgICAgICAgICdieV9iYW5kJzogeycyLjRHSHonOiAwLCAnNUdIeic6IDAsICc2R0h6JzogMH0sCiAgICAgICAgICAgICdieV9zZWN1cml0eSc6IHt9LAogICAgICAgICAgICAnYnlfdGhyZWF0Jzoge30KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgZm9yIG5ldHdvcmsgaW4gc2VsZi5uZXR3b3Jrcy52YWx1ZXMoKToKICAgICAgICAgICAgIyBDb3VudCBieSBiYW5kCiAgICAgICAgICAgIGlmIG5ldHdvcmsuYmFuZCBpbiBzZWxmLnN0YXRzWydieV9iYW5kJ106CiAgICAgICAgICAgICAgICBzZWxmLnN0YXRzWydieV9iYW5kJ11bbmV0d29yay5iYW5kXSArPSAxCiAgICAgICAgICAgIAogICAgICAgICAgICAjIENvdW50IGJ5IHNlY3VyaXR5IGxldmVsCiAgICAgICAgICAgIHNlYyA9IG5ldHdvcmsuc2VjdXJpdHlfbGV2ZWwKICAgICAgICAgICAgc2VsZi5zdGF0c1snYnlfc2VjdXJpdHknXVtzZWNdID0gc2VsZi5zdGF0c1snYnlfc2VjdXJpdHknXS5nZXQoc2VjLCAwKSArIDEKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQ291bnQgYnkgdGhyZWF0IGxldmVsCiAgICAgICAgICAgIHRocmVhdCA9IG5ldHdvcmsudGhyZWF0X2xldmVsCiAgICAgICAgICAgIHNlbGYuc3RhdHNbJ2J5X3RocmVhdCddW3RocmVhdF0gPSBzZWxmLnN0YXRzWydieV90aHJlYXQnXS5nZXQodGhyZWF0LCAwKSArIDEKICAgIAogICAgZGVmIGRpc3BsYXlfbmV0d29ya190YWJsZShzZWxmKToKICAgICAgICAiIiJEaXNwbGF5IG5ldHdvcmtzIGluIG9yZ2FuaXplZCB0YWJsZSBmb3JtYXQiIiIKICAgICAgICBpZiBub3Qgc2VsZi5uZXR3b3JrczoKICAgICAgICAgICAgcHJpbnQoZiJcbntzZWxmLmNvbG9yc1sneWVsbG93J1198J+UjSBTY2FubmluZyBmb3IgbmV0d29ya3MuLi57c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICAgICAgcHJpbnQoZiJ7c2VsZi5jb2xvcnNbJ2N5YW4nXX1NYWtlIHN1cmU6e3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgICAgIHByaW50KGYiICDigKIgV2lGaSBpcyBlbmFibGVkIikKICAgICAgICAgICAgcHJpbnQoZiIgIOKAoiBMb2NhdGlvbiBwZXJtaXNzaW9uIGdyYW50ZWQiKQogICAgICAgICAgICBwcmludChmIiAg4oCiIFlvdSdyZSBuZWFyIFdpRmkgbmV0d29ya3MiKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAKICAgICAgICAjIFNvcnQgbmV0d29ya3M6IHN1c3BpY2lvdXMgZmlyc3QsIHRoZW4gYnkgc2lnbmFsIHN0cmVuZ3RoCiAgICAgICAgc29ydGVkX25ldHMgPSBzb3J0ZWQoCiAgICAgICAgICAgIHNlbGYubmV0d29ya3MudmFsdWVzKCksCiAgICAgICAgICAgIGtleT1sYW1iZGEgeDogKHguaXNfc3VzcGljaW91cywgeC50aHJlYXRfbGV2ZWwsIHguc2lnbmFsX2RibSksCiAgICAgICAgICAgIHJldmVyc2U9VHJ1ZQogICAgICAgICkKICAgICAgICAKICAgICAgICAjIERpc3BsYXkgdGFibGUgaGVhZGVyCiAgICAgICAgcHJpbnQoZiJcbntzZWxmLmNvbG9yc1snYm9sZCddfXtzZWxmLmNvbG9yc1snY3lhbiddfeKUjOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUrOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUrOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUrOKUgOKUgOKUgOKUgOKUgOKUgOKUrOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUrOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUrOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUkCIpCiAgICAgICAgcHJpbnQoZiLilIIgeydUaHJlYXQnOjh9IOKUgiB7J1NTSUQnOjI4fSDilIIgeydTaWduYWwnOjh9IOKUgiB7J0NoJzo0fSDilIIgeydEaXN0Jzo4fSDilIIgeydTZWN1cml0eSc6MTF9IOKUgiB7J1Z1bG5lcmFiaWxpdHknOjEzfSDilIIiKQogICAgICAgIHByaW50KGYi4pSc4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pS84pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pS84pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pS84pSA4pSA4pSA4pSA4pSA4pSA4pS84pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pS84pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pS84pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSke3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgCiAgICAgICAgIyBEaXNwbGF5IGVhY2ggbmV0d29yawogICAgICAgIGZvciBuZXR3b3JrIGluIHNvcnRlZF9uZXRzWzoxNV06ICAjIFNob3cgdG9wIDE1CiAgICAgICAgICAgIHRocmVhdF9jb2xvciA9IG5ldHdvcmsuZ2V0X3RocmVhdF9jb2xvcigpCiAgICAgICAgICAgIHNlY19jb2xvciA9IG5ldHdvcmsuZ2V0X3NlY3VyaXR5X2NvbG9yKCkKICAgICAgICAgICAgCiAgICAgICAgICAgICMgVHJ1bmNhdGUgbG9uZyBTU0lEcwogICAgICAgICAgICBzc2lkX2Rpc3BsYXkgPSBuZXR3b3JrLnNzaWRbOjI4XSBpZiBsZW4obmV0d29yay5zc2lkKSA8PSAyOCBlbHNlIG5ldHdvcmsuc3NpZFs6MjVdICsgIi4uLiIKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQWRkIHdhcm5pbmcgaWNvbiBmb3Igc3VzcGljaW91cyBuZXR3b3JrcwogICAgICAgICAgICB0aHJlYXRfZGlzcGxheSA9IG5ldHdvcmsudGhyZWF0X2xldmVsCiAgICAgICAgICAgIGlmIG5ldHdvcmsuaXNfc3VzcGljaW91czoKICAgICAgICAgICAgICAgIHRocmVhdF9kaXNwbGF5ID0gZiLimqAge3RocmVhdF9kaXNwbGF5fSIKICAgICAgICAgICAgCiAgICAgICAgICAgICMgU2lnbmFsIHdpdGggcXVhbGl0eQogICAgICAgICAgICBzaWduYWxfZGlzcGxheSA9IGYie25ldHdvcmsuc2lnbmFsX2RibX1kQm0iCiAgICAgICAgICAgIGlmIG5ldHdvcmsuc2lnbmFsX3F1YWxpdHkgIT0gIlBvb3IiOgogICAgICAgICAgICAgICAgc2lnbmFsX2Rpc3BsYXkgKz0gZiIgKHtuZXR3b3JrLnNpZ25hbF9xdWFsaXR5WzBdfSkiCiAgICAgICAgICAgIAogICAgICAgICAgICAjIERpc3RhbmNlIGRpc3BsYXkKICAgICAgICAgICAgaWYgbmV0d29yay5lc3RpbWF0ZWRfZGlzdGFuY2UgPCAxOgogICAgICAgICAgICAgICAgZGlzdF9kaXNwbGF5ID0gZiJ7bmV0d29yay5lc3RpbWF0ZWRfZGlzdGFuY2U6LjFmfW0iCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBkaXN0X2Rpc3BsYXkgPSBmIntpbnQobmV0d29yay5lc3RpbWF0ZWRfZGlzdGFuY2UpfW0iCiAgICAgICAgICAgIAogICAgICAgICAgICAjIFZ1bG5lcmFiaWxpdHkgc2hvcnQgZGlzcGxheQogICAgICAgICAgICB2dWxuX3Nob3J0ID0gbmV0d29yay52dWxuZXJhYmlsaXR5WzoxM10KICAgICAgICAgICAgaWYgbGVuKG5ldHdvcmsudnVsbmVyYWJpbGl0eSkgPiAxMzoKICAgICAgICAgICAgICAgIHZ1bG5fc2hvcnQgPSBuZXR3b3JrLnZ1bG5lcmFiaWxpdHlbOjEwXSArICIuLi4iCiAgICAgICAgICAgIAogICAgICAgICAgICBwcmludChmIuKUgiB7dGhyZWF0X2NvbG9yfXt0aHJlYXRfZGlzcGxheTo4fXtzZWxmLmNvbG9yc1sncmVzZXQnXX0g4pSCICIKICAgICAgICAgICAgICAgICAgZiJ7c3NpZF9kaXNwbGF5OjI4fSDilIIgIgogICAgICAgICAgICAgICAgICBmIntzaWduYWxfZGlzcGxheTo4fSDilIIgIgogICAgICAgICAgICAgICAgICBmIntuZXR3b3JrLmNoYW5uZWw6NH0g4pSCICIKICAgICAgICAgICAgICAgICAgZiJ7ZGlzdF9kaXNwbGF5Ojh9IOKUgiAiCiAgICAgICAgICAgICAgICAgIGYie3NlY19jb2xvcn17bmV0d29yay5zZWN1cml0eV9sZXZlbFs6MTFdOjExfXtzZWxmLmNvbG9yc1sncmVzZXQnXX0g4pSCICIKICAgICAgICAgICAgICAgICAgZiJ7bmV0d29yay52dWxuZXJhYmlsaXR5WzoxM106MTN9IOKUgiIpCiAgICAgICAgCiAgICAgICAgcHJpbnQoZiJ7c2VsZi5jb2xvcnNbJ2JvbGQnXX17c2VsZi5jb2xvcnNbJ2N5YW4nXX3ilJTilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilLTilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilLTilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilLTilIDilIDilIDilIDilIDilIDilLTilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilLTilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilLTilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJh7c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICAKICAgICAgICBpZiBsZW4oc2VsZi5uZXR3b3JrcykgPiAxNToKICAgICAgICAgICAgcHJpbnQoZiJ7c2VsZi5jb2xvcnNbJ3llbGxvdyddfSAgLi4uIGFuZCB7bGVuKHNlbGYubmV0d29ya3MpIC0gMTV9IG1vcmUgbmV0d29ya3N7c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgIAogICAgZGVmIGRpc3BsYXlfc3RhdGlzdGljc19wYW5lbChzZWxmKToKICAgICAgICAiIiJEaXNwbGF5IGRldGFpbGVkIHN0YXRpc3RpY3MiIiIKICAgICAgICBpZiBub3Qgc2VsZi5uZXR3b3JrczoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgCiAgICAgICAgcHJpbnQoZiJcbntzZWxmLmNvbG9yc1snYm9sZCddfXtzZWxmLmNvbG9yc1snYmx1ZSddffCfk4ogU0NBTiBTVEFUSVNUSUNTe3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgcHJpbnQoZiJ7c2VsZi5jb2xvcnNbJ2N5YW4nXX17J+KUgCcgKiA2MH17c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICAKICAgICAgICAjIEJhc2ljIHN0YXRzCiAgICAgICAgcHJpbnQoZiJ7c2VsZi5jb2xvcnNbJ3doaXRlJ1194oCiIFRvdGFsIE5ldHdvcmtzOntzZWxmLmNvbG9yc1sncmVzZXQnXX0ge3NlbGYuc3RhdHNbJ3RvdGFsX25ldHdvcmtzJ119IikKICAgICAgICAKICAgICAgICAjIEJhbmQgZGlzdHJpYnV0aW9uCiAgICAgICAgYmFuZHMgPSBzZWxmLnN0YXRzWydieV9iYW5kJ10KICAgICAgICBwcmludChmIntzZWxmLmNvbG9yc1snd2hpdGUnXX3igKIgQmFuZCBEaXN0cmlidXRpb246e3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgZm9yIGJhbmQsIGNvdW50IGluIGJhbmRzLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIGNvdW50ID4gMDoKICAgICAgICAgICAgICAgIHBlcmNlbnRhZ2UgPSAoY291bnQgLyBzZWxmLnN0YXRzWyd0b3RhbF9uZXR3b3JrcyddKSAqIDEwMAogICAgICAgICAgICAgICAgYmFyX2xlbmd0aCA9IGludChwZXJjZW50YWdlIC8gNSkKICAgICAgICAgICAgICAgIGJhciA9ICfilognICogYmFyX2xlbmd0aCArICfilpEnICogKDIwIC0gYmFyX2xlbmd0aCkKICAgICAgICAgICAgICAgIHByaW50KGYiICAgIHtiYW5kOjd9IDoge2Jhcn0ge2NvdW50OjJkfSAoe3BlcmNlbnRhZ2U6LjFmfSUpIikKICAgICAgICAKICAgICAgICAjIFNlY3VyaXR5IGFuYWx5c2lzCiAgICAgICAgcHJpbnQoZiJcbntzZWxmLmNvbG9yc1snd2hpdGUnXX3igKIgU2VjdXJpdHkgQW5hbHlzaXM6e3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgcHJpbnQoZiIgICAge3NlbGYuY29sb3JzWydncmVlbiddfVNlY3VyZSBOZXR3b3Jrczp7c2VsZi5jb2xvcnNbJ3Jlc2V0J119IHtzZWxmLnN0YXRzWydzZWN1cmVfbmV0d29ya3MnXX0iKQogICAgICAgIHByaW50KGYiICAgIHtzZWxmLmNvbG9yc1sneWVsbG93J119Q3JhY2thYmxlIE5ldHdvcmtzOntzZWxmLmNvbG9yc1sncmVzZXQnXX0ge3NlbGYuc3RhdHNbJ2NyYWNrYWJsZV9uZXR3b3JrcyddfSIpCiAgICAgICAgcHJpbnQoZiIgICAge3NlbGYuY29sb3JzWydyZWQnXX1PcGVuIE5ldHdvcmtzOntzZWxmLmNvbG9yc1sncmVzZXQnXX0ge3NlbGYuc3RhdHNbJ29wZW5fbmV0d29ya3MnXX0iKQogICAgICAgIHByaW50KGYiICAgIHtzZWxmLmNvbG9yc1snbWFnZW50YSddfVN1c3BpY2lvdXMgTmV0d29ya3M6e3NlbGYuY29sb3JzWydyZXNldCddfSB7c2VsZi5zdGF0c1snc3VzcGljaW91c19uZXR3b3JrcyddfSIpCiAgICAgICAgCiAgICAgICAgIyBUaHJlYXQgbGV2ZWwgYnJlYWtkb3duCiAgICAgICAgcHJpbnQoZiJcbntzZWxmLmNvbG9yc1snd2hpdGUnXX3igKIgVGhyZWF0IExldmVsIEJyZWFrZG93bjp7c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICB0aHJlYXRzID0gc29ydGVkKHNlbGYuc3RhdHNbJ2J5X3RocmVhdCddLml0ZW1zKCksIAogICAgICAgICAgICAgICAgICAgICAgICBrZXk9bGFtYmRhIHg6IFsnQ1JJVElDQUwnLCAnSElHSCcsICdNRURJVU0nLCAnTE9XJywgJ1NBRkUnXS5pbmRleCh4WzBdKSAKICAgICAgICAgICAgICAgICAgICAgICAgaWYgeFswXSBpbiBbJ0NSSVRJQ0FMJywgJ0hJR0gnLCAnTUVESVVNJywgJ0xPVycsICdTQUZFJ10gZWxzZSAxMCkKICAgICAgICAKICAgICAgICBmb3IgdGhyZWF0LCBjb3VudCBpbiB0aHJlYXRzOgogICAgICAgICAgICBjb2xvciA9IHsKICAgICAgICAgICAgICAgICdDUklUSUNBTCc6IHNlbGYuY29sb3JzWydkYXJrX3JlZCddLAogICAgICAgICAgICAgICAgJ0hJR0gnOiBzZWxmLmNvbG9yc1sncmVkJ10sCiAgICAgICAgICAgICAgICAnTUVESVVNJzogc2VsZi5jb2xvcnNbJ29yYW5nZSddLAogICAgICAgICAgICAgICAgJ0xPVyc6IHNlbGYuY29sb3JzWydncmVlbiddLAogICAgICAgICAgICAgICAgJ1NBRkUnOiBzZWxmLmNvbG9yc1snY3lhbiddCiAgICAgICAgICAgIH0uZ2V0KHRocmVhdCwgc2VsZi5jb2xvcnNbJ3doaXRlJ10pCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBjb3VudCA+IDA6CiAgICAgICAgICAgICAgICBwZXJjZW50YWdlID0gKGNvdW50IC8gc2VsZi5zdGF0c1sndG90YWxfbmV0d29ya3MnXSkgKiAxMDAKICAgICAgICAgICAgICAgIGJhcl9sZW5ndGggPSBpbnQocGVyY2VudGFnZSAvIDUpCiAgICAgICAgICAgICAgICBiYXIgPSAn4paIJyAqIGJhcl9sZW5ndGggKyAn4paRJyAqICgyMCAtIGJhcl9sZW5ndGgpCiAgICAgICAgICAgICAgICBwcmludChmIiAgICB7Y29sb3J9e3RocmVhdDo4fXtzZWxmLmNvbG9yc1sncmVzZXQnXX0gOiB7YmFyfSB7Y291bnQ6MmR9ICh7cGVyY2VudGFnZTouMWZ9JSkiKQogICAgCiAgICBkZWYgZGlzcGxheV9jb250cm9sX3BhbmVsKHNlbGYpOgogICAgICAgICIiIkRpc3BsYXkgY29udHJvbCBwYW5lbCIiIgogICAgICAgIHByaW50KGYiXG57c2VsZi5jb2xvcnNbJ2JvbGQnXX17c2VsZi5jb2xvcnNbJ3B1cnBsZSddffCfjq4gQ09OVFJPTCBQQU5FTHtzZWxmLmNvbG9yc1sncmVzZXQnXX0iKQogICAgICAgIHByaW50KGYie3NlbGYuY29sb3JzWydjeWFuJ119eyfilIAnICogNjB9e3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgcHJpbnQoZiJ7c2VsZi5jb2xvcnNbJ3doaXRlJ119W1Fde3NlbGYuY29sb3JzWydyZXNldCddfXVpdCAgIgogICAgICAgICAgICAgIGYie3NlbGYuY29sb3JzWyd3aGl0ZSddfVtSXXtzZWxmLmNvbG9yc1sncmVzZXQnXX1lZnJlc2ggICIKICAgICAgICAgICAgICBmIntzZWxmLmNvbG9yc1snd2hpdGUnXX1bK117c2VsZi5jb2xvcnNbJ3Jlc2V0J119RmFzdGVyICAiCiAgICAgICAgICAgICAgZiJ7c2VsZi5jb2xvcnNbJ3doaXRlJ119Wy1de3NlbGYuY29sb3JzWydyZXNldCddfVNsb3dlciAgIgogICAgICAgICAgICAgIGYie3NlbGYuY29sb3JzWyd3aGl0ZSddfVtEXXtzZWxmLmNvbG9yc1sncmVzZXQnXX1ldGFpbHMgICIKICAgICAgICAgICAgICBmIntzZWxmLmNvbG9yc1snd2hpdGUnXX1bRV17c2VsZi5jb2xvcnNbJ3Jlc2V0J119eHBvcnQgICIKICAgICAgICAgICAgICBmIntzZWxmLmNvbG9yc1snd2hpdGUnXX1bU117c2VsZi5jb2xvcnNbJ3Jlc2V0J119ZXR0aW5ncyIpCiAgICAgICAgCiAgICAgICAgIyBTaG93IGN1cnJlbnQgc2NhbiBpbmZvCiAgICAgICAgZWxhcHNlZCA9IGRhdGV0aW1lLm5vdygpIC0gc2VsZi5zdGFydF90aW1lCiAgICAgICAgaG91cnMsIHJlbWFpbmRlciA9IGRpdm1vZChpbnQoZWxhcHNlZC50b3RhbF9zZWNvbmRzKCkpLCAzNjAwKQogICAgICAgIG1pbnV0ZXMsIHNlY29uZHMgPSBkaXZtb2QocmVtYWluZGVyLCA2MCkKICAgICAgICAKICAgICAgICBwcmludChmIlxue3NlbGYuY29sb3JzWydjeWFuJ119U2NhbiAje3NlbGYuc2Nhbl9jb3VudH0gfCAiCiAgICAgICAgICAgICAgZiJSdW5uaW5nOiB7aG91cnM6MDJkfTp7bWludXRlczowMmR9OntzZWNvbmRzOjAyZH0gfCAiCiAgICAgICAgICAgICAgZiJSZWZyZXNoOiB7c2VsZi5yZWZyZXNoX2ludGVydmFsfXN7c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgIAogICAgZGVmIGRpc3BsYXlfbmV0d29ya19kZXRhaWxzKHNlbGYpOgogICAgICAgICIiIlNob3cgZGV0YWlsZWQgaW5mb3JtYXRpb24gZm9yIGEgc3BlY2lmaWMgbmV0d29yayIiIgogICAgICAgIGlmIG5vdCBzZWxmLm5ldHdvcmtzOgogICAgICAgICAgICBwcmludChmIntzZWxmLmNvbG9yc1sneWVsbG93J119Tm8gbmV0d29ya3MgdG8gZGlzcGxheXtzZWxmLmNvbG9yc1sncmVzZXQnXX0iKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAKICAgICAgICBwcmludChmIlxue3NlbGYuY29sb3JzWydib2xkJ119e3NlbGYuY29sb3JzWydibHVlJ1198J+UjSBORVRXT1JLIERFVEFJTFN7c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICBwcmludChmIntzZWxmLmNvbG9yc1snY3lhbiddfXsn4pSAJyAqIDYwfXtzZWxmLmNvbG9yc1sncmVzZXQnXX0iKQogICAgICAgIAogICAgICAgICMgTGlzdCBuZXR3b3JrcyB3aXRoIG51bWJlcnMKICAgICAgICBuZXR3b3Jrc19saXN0ID0gbGlzdChzZWxmLm5ldHdvcmtzLnZhbHVlcygpKVs6MTBdCiAgICAgICAgZm9yIGksIG5ldCBpbiBlbnVtZXJhdGUobmV0d29ya3NfbGlzdCwgMSk6CiAgICAgICAgICAgIHRocmVhdF9jb2xvciA9IG5ldC5nZXRfdGhyZWF0X2NvbG9yKCkKICAgICAgICAgICAgcHJpbnQoZiJ7c2VsZi5jb2xvcnNbJ3doaXRlJ119W3tpfV17c2VsZi5jb2xvcnNbJ3Jlc2V0J119IHt0aHJlYXRfY29sb3J9e25ldC5zc2lkWzozMF06MzB9e3NlbGYuY29sb3JzWydyZXNldCddfSB8ICIKICAgICAgICAgICAgICAgICAgZiJ7bmV0LmJzc2lkfSB8IHtuZXQuc2lnbmFsX2RibX1kQm0gfCB7bmV0LnRocmVhdF9sZXZlbH0iKQogICAgICAgIAogICAgICAgIHByaW50KGYiXG57c2VsZi5jb2xvcnNbJ3doaXRlJ119U2VsZWN0IG5ldHdvcmsgKDEte2xlbihuZXR3b3Jrc19saXN0KX0pIG9yIFswXSB0byBnbyBiYWNrOntzZWxmLmNvbG9yc1sncmVzZXQnXX0gIikKICAgICAgICAKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgU2V0IHVwIG5vbi1ibG9ja2luZyBpbnB1dAogICAgICAgICAgICBpbXBvcnQgc2VsZWN0CiAgICAgICAgICAgIGltcG9ydCB0ZXJtaW9zCiAgICAgICAgICAgIGltcG9ydCB0dHkKICAgICAgICAgICAgCiAgICAgICAgICAgIGZkID0gc3lzLnN0ZGluLmZpbGVubygpCiAgICAgICAgICAgIG9sZF9zZXR0aW5ncyA9IHRlcm1pb3MudGNnZXRhdHRyKGZkKQogICAgICAgICAgICAKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgdHR5LnNldHJhdyhmZCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBXYWl0IGZvciBpbnB1dCBmb3IgMyBzZWNvbmRzCiAgICAgICAgICAgICAgICBzdGFydF90aW1lID0gdGltZS50aW1lKCkKICAgICAgICAgICAgICAgIHdoaWxlIHRpbWUudGltZSgpIC0gc3RhcnRfdGltZSA8IDM6CiAgICAgICAgICAgICAgICAgICAgaWYgc2VsZWN0LnNlbGVjdChbc3lzLnN0ZGluXSwgW10sIFtdLCAwLjEpWzBdOgogICAgICAgICAgICAgICAgICAgICAgICBjaG9pY2UgPSBzeXMuc3RkaW4ucmVhZCgxKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBjaG9pY2UuaXNkaWdpdCgpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hvaWNlID0gaW50KGNob2ljZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIDEgPD0gY2hvaWNlIDw9IGxlbihuZXR3b3Jrc19saXN0KToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNob3dfc2luZ2xlX25ldHdvcmtfZGV0YWlscyhuZXR3b3Jrc19saXN0W2Nob2ljZS0xXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgdGltZS5zbGVlcCgwLjEpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgICAgICB0ZXJtaW9zLnRjc2V0YXR0cihmZCwgdGVybWlvcy5UQ1NBRFJBSU4sIG9sZF9zZXR0aW5ncykKICAgICAgICAgICAgICAgIAogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgCiAgICBkZWYgc2hvd19zaW5nbGVfbmV0d29ya19kZXRhaWxzKHNlbGYsIG5ldHdvcmspOgogICAgICAgICIiIlNob3cgZGV0YWlsZWQgaW5mb3JtYXRpb24gZm9yIGEgc2luZ2xlIG5ldHdvcmsiIiIKICAgICAgICBvcy5zeXN0ZW0oJ2NsZWFyJykKICAgICAgICBwcmludChmIntzZWxmLmNvbG9yc1snYm9sZCddfXtzZWxmLmNvbG9yc1snYmx1ZSddfSIpCiAgICAgICAgcHJpbnQoIuKVlOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVlyIpCiAgICAgICAgcHJpbnQoIuKVkSAgICAgICAgICAgICAgICAgTkVUV09SSyBTRUNVUklUWSBBTkFMWVNJUyAgICAgICAgICAgICAgICAgICAg4pWRIikKICAgICAgICBwcmludCgi4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIikKICAgICAgICBwcmludChmIntzZWxmLmNvbG9yc1sncmVzZXQnXX0iKQogICAgICAgIAogICAgICAgIHRocmVhdF9jb2xvciA9IG5ldHdvcmsuZ2V0X3RocmVhdF9jb2xvcigpCiAgICAgICAgc2VjX2NvbG9yID0gbmV0d29yay5nZXRfc2VjdXJpdHlfY29sb3IoKQogICAgICAgIAogICAgICAgIHByaW50KGYiXG57c2VsZi5jb2xvcnNbJ2JvbGQnXX3wn5OhIE5FVFdPUksgSURFTlRJRklDQVRJT057c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICBwcmludChmIiAgU1NJRCAgICAgICAgOiB7bmV0d29yay5zc2lkfSIpCiAgICAgICAgcHJpbnQoZiIgIEJTU0lEICAgICAgIDoge25ldHdvcmsuYnNzaWR9IikKICAgICAgICBwcmludChmIiAgRmlyc3QgU2VlbiAgOiB7bmV0d29yay5maXJzdF9zZWVuLnN0cmZ0aW1lKCclSDolTTolUycpfSIpCiAgICAgICAgcHJpbnQoZiIgIExhc3QgU2VlbiAgIDoge25ldHdvcmsubGFzdF9zZWVuLnN0cmZ0aW1lKCclSDolTTolUycpfSIpCiAgICAgICAgCiAgICAgICAgcHJpbnQoZiJcbntzZWxmLmNvbG9yc1snYm9sZCddffCfk7YgU0lHTkFMIEFOQUxZU0lTe3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgcHJpbnQoZiIgIFNpZ25hbCAgICAgIDoge25ldHdvcmsuc2lnbmFsX2RibX0gZEJtICh7bmV0d29yay5zaWduYWxfcXVhbGl0eX0pIikKICAgICAgICBwcmludChmIiAgQmFuZCAgICAgICAgOiB7bmV0d29yay5iYW5kfSIpCiAgICAgICAgcHJpbnQoZiIgIENoYW5uZWwgICAgIDoge25ldHdvcmsuY2hhbm5lbH0iKQogICAgICAgIHByaW50KGYiICBGcmVxdWVuY3kgICA6IHtuZXR3b3JrLmZyZXF1ZW5jeX0gTUh6IikKICAgICAgICBwcmludChmIiAgRGlzdGFuY2UgICAgOiB+e25ldHdvcmsuZXN0aW1hdGVkX2Rpc3RhbmNlOi4xZn0gbWV0ZXJzIikKICAgICAgICAKICAgICAgICBwcmludChmIlxue3NlbGYuY29sb3JzWydib2xkJ1198J+UkiBTRUNVUklUWSBBTkFMWVNJU3tzZWxmLmNvbG9yc1sncmVzZXQnXX0iKQogICAgICAgIHByaW50KGYiICBFbmNyeXB0aW9uICA6IHtzZWNfY29sb3J9e25ldHdvcmsuZW5jcnlwdGlvbl90eXBlfXtzZWxmLmNvbG9yc1sncmVzZXQnXX0iKQogICAgICAgIHByaW50KGYiICBTZWN1cml0eSAgICA6IHtzZWNfY29sb3J9e25ldHdvcmsuc2VjdXJpdHlfbGV2ZWx9e3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgcHJpbnQoZiIgIFZ1bG5lcmFiaWxpdHk6IHtuZXR3b3JrLnZ1bG5lcmFiaWxpdHl9IikKICAgICAgICAKICAgICAgICBwcmludChmIlxue3NlbGYuY29sb3JzWydib2xkJ1194pqg77iPICBUSFJFQVQgQVNTRVNTTUVOVHtzZWxmLmNvbG9yc1sncmVzZXQnXX0iKQogICAgICAgIHByaW50KGYiICBUaHJlYXQgTGV2ZWw6IHt0aHJlYXRfY29sb3J9e25ldHdvcmsudGhyZWF0X2xldmVsfXtzZWxmLmNvbG9yc1sncmVzZXQnXX0iKQogICAgICAgIHByaW50KGYiICBTdXNwaWNpb3VzICA6IHsnWUVTJyBpZiBuZXR3b3JrLmlzX3N1c3BpY2lvdXMgZWxzZSAnTk8nfSIpCiAgICAgICAgCiAgICAgICAgIyBTZWN1cml0eSByZWNvbW1lbmRhdGlvbnMKICAgICAgICBwcmludChmIlxue3NlbGYuY29sb3JzWydib2xkJ1198J+SoSBTRUNVUklUWSBSRUNPTU1FTkRBVElPTlN7c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICBpZiBuZXR3b3JrLnNlY3VyaXR5X2xldmVsID09ICdObyBTZWN1cml0eSc6CiAgICAgICAgICAgIHByaW50KGYiICB7c2VsZi5jb2xvcnNbJ3JlZCddfeKdjCBFWFRSRU1FTFkgVlVMTkVSQUJMRSAtIEF2b2lkIGNvbm5lY3Rpbmd7c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICBlbGlmICdDcmFja2FibGUnIGluIG5ldHdvcmsudnVsbmVyYWJpbGl0eToKICAgICAgICAgICAgcHJpbnQoZiIgIHtzZWxmLmNvbG9yc1sneWVsbG93J1194pqg77iPICBWVUxORVJBQkxFIC0gVXNlIHN0cm9uZyBwYXNzd29yZHN7c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICBlbGlmIG5ldHdvcmsuc2VjdXJpdHlfbGV2ZWwgaW4gWydTZWN1cmUnLCAnVmVyeSBTZWN1cmUnXToKICAgICAgICAgICAgcHJpbnQoZiIgIHtzZWxmLmNvbG9yc1snZ3JlZW4nXX3inIUgU0VDVVJFIC0gU2FmZSBmb3IgY29ubmVjdGlvbnN7c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICAKICAgICAgICBpbnB1dChmIlxue3NlbGYuY29sb3JzWydjeWFuJ119UHJlc3MgRW50ZXIgdG8gY29udGludWUuLi57c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgIAogICAgZGVmIGV4cG9ydF9yZXN1bHRzKHNlbGYpOgogICAgICAgICIiIkV4cG9ydCBzY2FuIHJlc3VsdHMgdG8gZmlsZSIiIgogICAgICAgIGlmIG5vdCBzZWxmLm5ldHdvcmtzOgogICAgICAgICAgICBwcmludChmIntzZWxmLmNvbG9yc1sneWVsbG93J119Tm8gbmV0d29ya3MgdG8gZXhwb3J0e3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIAogICAgICAgIGZpbGVuYW1lID0gZiJjbWRoYWNrX3dpZmlfc2Nhbl97ZGF0ZXRpbWUubm93KCkuc3RyZnRpbWUoJyVZJW0lZF8lSCVNJVMnKX0udHh0IgogICAgICAgIAogICAgICAgIHRyeToKICAgICAgICAgICAgd2l0aCBvcGVuKGZpbGVuYW1lLCAndycpIGFzIGY6CiAgICAgICAgICAgICAgICBmLndyaXRlKCI9IiAqIDcwICsgIlxuIikKICAgICAgICAgICAgICAgIGYud3JpdGUoIkNPTVJBREVIQUNLRVIgVEVBTSBDTURIQUNLIC0gV0lGSSBTQ0FOIFJFUE9SVFxuIikKICAgICAgICAgICAgICAgIGYud3JpdGUoIj0iICogNzAgKyAiXG5cbiIpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGYud3JpdGUoZiJTY2FuIFRpbWU6IHtkYXRldGltZS5ub3coKS5zdHJmdGltZSgnJVktJW0tJWQgJUg6JU06JVMnKX1cbiIpCiAgICAgICAgICAgICAgICBmLndyaXRlKGYiVG90YWwgTmV0d29ya3M6IHtsZW4oc2VsZi5uZXR3b3Jrcyl9XG4iKQogICAgICAgICAgICAgICAgZi53cml0ZShmIlN1c3BpY2lvdXMgTmV0d29ya3M6IHtzZWxmLnN0YXRzWydzdXNwaWNpb3VzX25ldHdvcmtzJ119XG5cbiIpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGYud3JpdGUoIi0iICogNzAgKyAiXG4iKQogICAgICAgICAgICAgICAgZi53cml0ZSgiREVURUNURUQgTkVUV09SS1M6XG4iKQogICAgICAgICAgICAgICAgZi53cml0ZSgiLSIgKiA3MCArICJcblxuIikKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZm9yIG5ldHdvcmsgaW4gc2VsZi5uZXR3b3Jrcy52YWx1ZXMoKToKICAgICAgICAgICAgICAgICAgICBmLndyaXRlKGYiU1NJRDoge25ldHdvcmsuc3NpZH1cbiIpCiAgICAgICAgICAgICAgICAgICAgZi53cml0ZShmIkJTU0lEOiB7bmV0d29yay5ic3NpZH1cbiIpCiAgICAgICAgICAgICAgICAgICAgZi53cml0ZShmIlNpZ25hbDoge25ldHdvcmsuc2lnbmFsX2RibX0gZEJtXG4iKQogICAgICAgICAgICAgICAgICAgIGYud3JpdGUoZiJEaXN0YW5jZTogfntuZXR3b3JrLmVzdGltYXRlZF9kaXN0YW5jZTouMWZ9bVxuIikKICAgICAgICAgICAgICAgICAgICBmLndyaXRlKGYiQmFuZDoge25ldHdvcmsuYmFuZH0gfCBDaGFubmVsOiB7bmV0d29yay5jaGFubmVsfVxuIikKICAgICAgICAgICAgICAgICAgICBmLndyaXRlKGYiU2VjdXJpdHk6IHtuZXR3b3JrLmVuY3J5cHRpb25fdHlwZX1cbiIpCiAgICAgICAgICAgICAgICAgICAgZi53cml0ZShmIlZ1bG5lcmFiaWxpdHk6IHtuZXR3b3JrLnZ1bG5lcmFiaWxpdHl9XG4iKQogICAgICAgICAgICAgICAgICAgIGYud3JpdGUoZiJUaHJlYXQgTGV2ZWw6IHtuZXR3b3JrLnRocmVhdF9sZXZlbH1cbiIpCiAgICAgICAgICAgICAgICAgICAgZi53cml0ZShmIlN1c3BpY2lvdXM6IHsnWUVTJyBpZiBuZXR3b3JrLmlzX3N1c3BpY2lvdXMgZWxzZSAnTk8nfVxuIikKICAgICAgICAgICAgICAgICAgICBmLndyaXRlKCItIiAqIDUwICsgIlxuXG4iKQogICAgICAgICAgICAKICAgICAgICAgICAgcHJpbnQoZiJ7c2VsZi5jb2xvcnNbJ2dyZWVuJ1194pyTIFJlc3VsdHMgZXhwb3J0ZWQgdG86IHtmaWxlbmFtZX17c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICAgICAgCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBwcmludChmIntzZWxmLmNvbG9yc1sncmVkJ1194pyXIEV4cG9ydCBmYWlsZWQ6IHtlfXtzZWxmLmNvbG9yc1sncmVzZXQnXX0iKQogICAgCiAgICBkZWYgaGFuZGxlX2lucHV0KHNlbGYpOgogICAgICAgICIiIkhhbmRsZSBrZXlib2FyZCBpbnB1dCIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgZmQgPSBzeXMuc3RkaW4uZmlsZW5vKCkKICAgICAgICAgICAgb2xkX3NldHRpbmdzID0gdGVybWlvcy50Y2dldGF0dHIoZmQpCiAgICAgICAgICAgIAogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB0dHkuc2V0cmF3KGZkKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBzZWxlY3Quc2VsZWN0KFtzeXMuc3RkaW5dLCBbXSwgW10sIDAuMSlbMF06CiAgICAgICAgICAgICAgICAgICAga2V5ID0gc3lzLnN0ZGluLnJlYWQoMSkubG93ZXIoKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIGtleSA9PSAncSc6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucnVubmluZyA9IEZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYiXG57c2VsZi5jb2xvcnNbJ3llbGxvdyddfVN0b3BwaW5nIHNjYW5uZXIuLi57c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICAgICAgICAgICAgICBlbGlmIGtleSA9PSAncic6CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYiXG57c2VsZi5jb2xvcnNbJ2dyZWVuJ119TWFudWFsIHJlZnJlc2ggdHJpZ2dlcmVkLi4ue3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucGVyZm9ybV9zY2FuKCkKICAgICAgICAgICAgICAgICAgICBlbGlmIGtleSA9PSAnKyc6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHNlbGYucmVmcmVzaF9pbnRlcnZhbCA+IDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlZnJlc2hfaW50ZXJ2YWwgLT0gMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJcbntzZWxmLmNvbG9yc1snZ3JlZW4nXX1TY2FubmluZyBmYXN0ZXI6IHtzZWxmLnJlZnJlc2hfaW50ZXJ2YWx9c3tzZWxmLmNvbG9yc1sncmVzZXQnXX0iKQogICAgICAgICAgICAgICAgICAgIGVsaWYga2V5ID09ICctJzoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgc2VsZi5yZWZyZXNoX2ludGVydmFsIDwgMzA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlZnJlc2hfaW50ZXJ2YWwgKz0gMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJcbntzZWxmLmNvbG9yc1snZ3JlZW4nXX1TY2FubmluZyBzbG93ZXI6IHtzZWxmLnJlZnJlc2hfaW50ZXJ2YWx9c3tzZWxmLmNvbG9yc1sncmVzZXQnXX0iKQogICAgICAgICAgICAgICAgICAgIGVsaWYga2V5ID09ICdkJzoKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kaXNwbGF5X25ldHdvcmtfZGV0YWlscygpCiAgICAgICAgICAgICAgICAgICAgZWxpZiBrZXkgPT0gJ2UnOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmV4cG9ydF9yZXN1bHRzKCkKICAgICAgICAgICAgICAgICAgICBlbGlmIGtleSA9PSAncyc6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2hvd19zZXR0aW5ncygpCiAgICAgICAgICAgICAgICAgICAgZWxpZiBrZXkgPT0gJ2MnOgogICAgICAgICAgICAgICAgICAgICAgICBvcy5zeXN0ZW0oJ2NsZWFyJykKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgICAgICB0ZXJtaW9zLnRjc2V0YXR0cihmZCwgdGVybWlvcy5UQ1NBRFJBSU4sIG9sZF9zZXR0aW5ncykKICAgICAgICAgICAgICAgIAogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgCiAgICBkZWYgcGVyZm9ybV9zY2FuKHNlbGYpOgogICAgICAgICIiIlBlcmZvcm0gYSBzaW5nbGUgc2NhbiBjeWNsZSIiIgogICAgICAgIHNlbGYuc2Nhbl9jb3VudCArPSAxCiAgICAgICAgCiAgICAgICAgIyBHZXQgbmV3IHNjYW4gcmVzdWx0cwogICAgICAgIHJhd19yZXN1bHRzID0gc2VsZi5nZXRfc2Nhbl9yZXN1bHRzKCkKICAgICAgICAKICAgICAgICBpZiByYXdfcmVzdWx0czoKICAgICAgICAgICAgIyBVcGRhdGUgZXhpc3RpbmcgbmV0d29ya3MKICAgICAgICAgICAgY3VycmVudF90aW1lID0gZGF0ZXRpbWUubm93KCkKICAgICAgICAgICAgCiAgICAgICAgICAgIGZvciByYXdfbmV0IGluIHJhd19yZXN1bHRzOgogICAgICAgICAgICAgICAgbmV0d29yayA9IHNlbGYucGFyc2VfbmV0d29yayhyYXdfbmV0KQogICAgICAgICAgICAgICAgaWYgbmV0d29yazoKICAgICAgICAgICAgICAgICAgICBzZWxmLm5ldHdvcmtzW25ldHdvcmsuYnNzaWRdID0gbmV0d29yawogICAgICAgICAgICAKICAgICAgICAgICAgIyBSZW1vdmUgb2xkIG5ldHdvcmtzIChub3Qgc2VlbiBpbiBsYXN0IDMwIHNlY29uZHMpCiAgICAgICAgICAgIG9sZF9ic3NpZHMgPSBbXQogICAgICAgICAgICBmb3IgYnNzaWQsIG5ldCBpbiBzZWxmLm5ldHdvcmtzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICB0aW1lX2RpZmYgPSAoY3VycmVudF90aW1lIC0gbmV0Lmxhc3Rfc2VlbikudG90YWxfc2Vjb25kcygpCiAgICAgICAgICAgICAgICBpZiB0aW1lX2RpZmYgPiAzMDoKICAgICAgICAgICAgICAgICAgICBvbGRfYnNzaWRzLmFwcGVuZChic3NpZCkKICAgICAgICAgICAgCiAgICAgICAgICAgIGZvciBic3NpZCBpbiBvbGRfYnNzaWRzOgogICAgICAgICAgICAgICAgZGVsIHNlbGYubmV0d29ya3NbYnNzaWRdCiAgICAgICAgICAgIAogICAgICAgICAgICAjIFVwZGF0ZSBzdGF0aXN0aWNzCiAgICAgICAgICAgIHNlbGYudXBkYXRlX3N0YXRpc3RpY3MoKQogICAgCiAgICBkZWYgc2Nhbl9sb29wKHNlbGYpOgogICAgICAgICIiIk1haW4gc2Nhbm5pbmcgbG9vcCIiIgogICAgICAgIHdoaWxlIHNlbGYucnVubmluZzoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VsZi5wZXJmb3JtX3NjYW4oKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIERpc3BsYXkgcmVzdWx0cwogICAgICAgICAgICAgICAgb3Muc3lzdGVtKCdjbGVhcicpCiAgICAgICAgICAgICAgICBzZWxmLmRpc3BsYXlfYmFubmVyKCkKICAgICAgICAgICAgICAgIHNlbGYuZGlzcGxheV9uZXR3b3JrX3RhYmxlKCkKICAgICAgICAgICAgICAgIHNlbGYuZGlzcGxheV9zdGF0aXN0aWNzX3BhbmVsKCkKICAgICAgICAgICAgICAgIHNlbGYuZGlzcGxheV9jb250cm9sX3BhbmVsKCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBXYWl0IGZvciBuZXh0IHNjYW4KICAgICAgICAgICAgICAgIGZvciBfIGluIHJhbmdlKHNlbGYucmVmcmVzaF9pbnRlcnZhbCAqIDIpOgogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBzZWxmLnJ1bm5pbmc6CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYW5kbGVfaW5wdXQoKQogICAgICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMC41KQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgICAgICAgICBzZWxmLnJ1bm5pbmcgPSBGYWxzZQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7c2VsZi5jb2xvcnNbJ3JlZCddfUVycm9yOiB7ZX17c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkKICAgIAogICAgZGVmIHNob3dfc2V0dGluZ3Moc2VsZik6CiAgICAgICAgIiIiU2hvdyBzZXR0aW5ncyBtZW51IiIiCiAgICAgICAgb3Muc3lzdGVtKCdjbGVhcicpCiAgICAgICAgcHJpbnQoZiJ7c2VsZi5jb2xvcnNbJ2JvbGQnXX17c2VsZi5jb2xvcnNbJ2JsdWUnXX0iKQogICAgICAgIHByaW50KCLilZTilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZciKQogICAgICAgIHByaW50KCLilZEgICAgICAgICAgICAgICAgICAgICAgICBTRVRUSU5HUyBNRU5VICAgICAgICAgICAgICAgICAgICAgICAgIOKVkSIpCiAgICAgICAgcHJpbnQoIuKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVnSIpCiAgICAgICAgcHJpbnQoZiJ7c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICAKICAgICAgICBwcmludChmIlxue3NlbGYuY29sb3JzWydjeWFuJ119Q3VycmVudCBTZXR0aW5nczp7c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICBwcmludChmIiAgMS4gUmVmcmVzaCBJbnRlcnZhbDoge3NlbGYucmVmcmVzaF9pbnRlcnZhbH0gc2Vjb25kcyIpCiAgICAgICAgcHJpbnQoZiIgIDIuIERpc3BsYXkgTW9kZTogQWR2YW5jZWQiKQogICAgICAgIHByaW50KGYiICAzLiBUaHJlYXQgRGV0ZWN0aW9uOiBFbmFibGVkIikKICAgICAgICBwcmludChmIiAgNC4gRGlzdGFuY2UgRXN0aW1hdGlvbjogRW5hYmxlZCIpCiAgICAgICAgCiAgICAgICAgcHJpbnQoZiJcbntzZWxmLmNvbG9yc1snY3lhbiddfU9wdGlvbnM6e3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgcHJpbnQoZiIgIFsxXSBDaGFuZ2UgcmVmcmVzaCBpbnRlcnZhbCIpCiAgICAgICAgcHJpbnQoZiIgIFsyXSBUb2dnbGUgdGhyZWF0IGRldGVjdGlvbiIpCiAgICAgICAgcHJpbnQoZiIgIFszXSBUb2dnbGUgZGlzdGFuY2UgZXN0aW1hdGlvbiIpCiAgICAgICAgcHJpbnQoZiIgIFs0XSBDbGVhciBuZXR3b3JrIGNhY2hlIikKICAgICAgICBwcmludChmIiAgWzVdIFRlc3QgVGVybXV4IEFQSSIpCiAgICAgICAgcHJpbnQoZiIgIFs2XSBCYWNrIHRvIHNjYW5uZXIiKQogICAgICAgIAogICAgICAgIGNob2ljZSA9IGlucHV0KGYiXG57c2VsZi5jb2xvcnNbJ3doaXRlJ119U2VsZWN0IG9wdGlvbjp7c2VsZi5jb2xvcnNbJ3Jlc2V0J119ICIpCiAgICAgICAgCiAgICAgICAgaWYgY2hvaWNlID09ICcxJzoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgaW50ZXJ2YWwgPSBpbnQoaW5wdXQoIk5ldyBpbnRlcnZhbCAoMS0zMHMpOiAiKSkKICAgICAgICAgICAgICAgIGlmIDEgPD0gaW50ZXJ2YWwgPD0gMzA6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZWZyZXNoX2ludGVydmFsID0gaW50ZXJ2YWwKICAgICAgICAgICAgICAgICAgICBwcmludChmIntzZWxmLmNvbG9yc1snZ3JlZW4nXX1JbnRlcnZhbCB1cGRhdGVke3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHByaW50KGYie3NlbGYuY29sb3JzWydyZWQnXX1JbnZhbGlkIGlucHV0e3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgZWxpZiBjaG9pY2UgPT0gJzQnOgogICAgICAgICAgICBzZWxmLm5ldHdvcmtzLmNsZWFyKCkKICAgICAgICAgICAgcHJpbnQoZiJ7c2VsZi5jb2xvcnNbJ2dyZWVuJ119TmV0d29yayBjYWNoZSBjbGVhcmVke3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkKICAgIAogICAgZGVmIHN0YXJ0KHNlbGYpOgogICAgICAgICIiIlN0YXJ0IHRoZSBzY2FubmVyIiIiCiAgICAgICAgc2VsZi5kaXNwbGF5X2Jhbm5lcigpCiAgICAgICAgCiAgICAgICAgIyBDaGVjayBzZXR1cAogICAgICAgIGlmIG5vdCBzZWxmLmNoZWNrX3NldHVwKCk6CiAgICAgICAgICAgIHByaW50KGYiXG57c2VsZi5jb2xvcnNbJ3llbGxvdyddfVNldHVwIGluY29tcGxldGUuIEF0dGVtcHRpbmcgdG8gY29udGludWUgYW55d2F5Li4ue3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMikKICAgICAgICAKICAgICAgICBwcmludChmIlxue3NlbGYuY29sb3JzWydncmVlbiddfVN0YXJ0aW5nIENvbXJhZGVIYWNrZXIgV2lGaSBBbmFseXplci4uLntzZWxmLmNvbG9yc1sncmVzZXQnXX0iKQogICAgICAgIHByaW50KGYie3NlbGYuY29sb3JzWydjeWFuJ119SW5pdGlhbGl6aW5nIHNlY3VyaXR5IG1vZHVsZXMuLi57c2VsZi5jb2xvcnNbJ3Jlc2V0J119IikKICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgCiAgICAgICAgc2VsZi5ydW5uaW5nID0gVHJ1ZQogICAgICAgIHNlbGYuc3RhcnRfdGltZSA9IGRhdGV0aW1lLm5vdygpCiAgICAgICAgCiAgICAgICAgIyBTdGFydCBzY2FuIHRocmVhZAogICAgICAgIHNlbGYuc2Nhbl90aHJlYWQgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1zZWxmLnNjYW5fbG9vcCkKICAgICAgICBzZWxmLnNjYW5fdGhyZWFkLmRhZW1vbiA9IFRydWUKICAgICAgICBzZWxmLnNjYW5fdGhyZWFkLnN0YXJ0KCkKICAgICAgICAKICAgICAgICAjIFdhaXQgZm9yIHRocmVhZCB0byBjb21wbGV0ZQogICAgICAgIHRyeToKICAgICAgICAgICAgd2hpbGUgc2VsZi5ydW5uaW5nIGFuZCBzZWxmLnNjYW5fdGhyZWFkLmlzX2FsaXZlKCk6CiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDAuMSkKICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgICAgIHNlbGYucnVubmluZyA9IEZhbHNlCiAgICAgICAgCiAgICAgICAgIyBDbGVhbnVwCiAgICAgICAgaWYgc2VsZi5zY2FuX3RocmVhZDoKICAgICAgICAgICAgc2VsZi5zY2FuX3RocmVhZC5qb2luKHRpbWVvdXQ9MikKICAgICAgICAKICAgICAgICBwcmludChmIlxue3NlbGYuY29sb3JzWyd5ZWxsb3cnXX1TY2FubmVyIHN0b3BwZWQue3NlbGYuY29sb3JzWydyZXNldCddfSIpCiAgICAgICAgcHJpbnQoZiJ7c2VsZi5jb2xvcnNbJ2N5YW4nXX1GaW5hbCBTdGF0aXN0aWNzOntzZWxmLmNvbG9yc1sncmVzZXQnXX0iKQogICAgICAgIHByaW50KGYiICBUb3RhbCBzY2Fuczoge3NlbGYuc2Nhbl9jb3VudH0iKQogICAgICAgIHByaW50KGYiICBOZXR3b3JrcyBkZXRlY3RlZDoge2xlbihzZWxmLm5ldHdvcmtzKX0iKQogICAgICAgIHByaW50KGYiICBTdXNwaWNpb3VzIG5ldHdvcmtzOiB7c2VsZi5zdGF0c1snc3VzcGljaW91c19uZXR3b3JrcyddfSIpCiAgICAgICAgcHJpbnQoZiIgIFNjYW4gZHVyYXRpb246IHtzdHIoZGF0ZXRpbWUubm93KCkgLSBzZWxmLnN0YXJ0X3RpbWUpLnNwbGl0KCcuJylbMF19IikKICAgICAgICAKICAgICAgICAjIEFzayBmb3IgZXhwb3J0CiAgICAgICAgaWYgc2VsZi5uZXR3b3JrczoKICAgICAgICAgICAgZXhwb3J0ID0gaW5wdXQoZiJcbntzZWxmLmNvbG9yc1snd2hpdGUnXX1FeHBvcnQgcmVzdWx0cz8gKHkvTik6IHtzZWxmLmNvbG9yc1sncmVzZXQnXX0iKS5sb3dlcigpCiAgICAgICAgICAgIGlmIGV4cG9ydCA9PSAneSc6CiAgICAgICAgICAgICAgICBzZWxmLmV4cG9ydF9yZXN1bHRzKCkKCmRlZiBtYWluKCk6CiAgICAiIiJNYWluIGZ1bmN0aW9uIiIiCiAgICBzY2FubmVyID0gQ29tcmFkZUhhY2tlcldpRmlTY2FubmVyKHJlZnJlc2hfaW50ZXJ2YWw9NSkKICAgIHNjYW5uZXIuc3RhcnQoKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIG1haW4oKQ==').decode('utf-8'))
